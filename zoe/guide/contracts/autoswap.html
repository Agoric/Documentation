<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Autoswap | Alpha</title>
    <meta name="generator" content="VuePress 1.6.0">
    <link rel="icon" href="/documentation/favicon-full.ico">
    <style type="text/css">
    .two-col-table td {
        width: 50%;
    }
    .two-col-table table {
        table-layout: fixed;
    }</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-118217811-1"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-118217811-1'); </script>
    <script>
    const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://agoric.com");
      homeEl.setAttribute("onclick", "return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://agoric.com';return false;");
      clearInterval(logoUrlChanger);
    }
   }, 1000) </script>
    <meta name="description" content="Build, deploy and operate dApps and DeFi markets.">
    <link rel="preload" href="/documentation/assets/css/0.styles.35b86ec1.css" as="style"><link rel="preload" href="/documentation/assets/js/app.bbb45119.js" as="script"><link rel="preload" href="/documentation/assets/js/2.58eb442a.js" as="script"><link rel="preload" href="/documentation/assets/js/52.d1b94f53.js" as="script"><link rel="preload" href="/documentation/assets/js/18.2e7dec5a.js" as="script"><link rel="prefetch" href="/documentation/assets/js/10.dee1c795.js"><link rel="prefetch" href="/documentation/assets/js/11.d8cf4c4f.js"><link rel="prefetch" href="/documentation/assets/js/12.06a8038c.js"><link rel="prefetch" href="/documentation/assets/js/13.6c5e2479.js"><link rel="prefetch" href="/documentation/assets/js/14.e94772c7.js"><link rel="prefetch" href="/documentation/assets/js/15.a599784b.js"><link rel="prefetch" href="/documentation/assets/js/16.2c8056cc.js"><link rel="prefetch" href="/documentation/assets/js/17.b6aaf0dc.js"><link rel="prefetch" href="/documentation/assets/js/19.8889f897.js"><link rel="prefetch" href="/documentation/assets/js/20.a6ae31ed.js"><link rel="prefetch" href="/documentation/assets/js/21.f89ecea2.js"><link rel="prefetch" href="/documentation/assets/js/22.ee7f96bf.js"><link rel="prefetch" href="/documentation/assets/js/23.4ccfb91e.js"><link rel="prefetch" href="/documentation/assets/js/24.05f914d6.js"><link rel="prefetch" href="/documentation/assets/js/25.5be0a942.js"><link rel="prefetch" href="/documentation/assets/js/26.96e20763.js"><link rel="prefetch" href="/documentation/assets/js/27.f7b2406b.js"><link rel="prefetch" href="/documentation/assets/js/28.0f09b340.js"><link rel="prefetch" href="/documentation/assets/js/29.416d5404.js"><link rel="prefetch" href="/documentation/assets/js/3.15a7d34c.js"><link rel="prefetch" href="/documentation/assets/js/30.9c3aaff1.js"><link rel="prefetch" href="/documentation/assets/js/31.ec5d0f4a.js"><link rel="prefetch" href="/documentation/assets/js/32.7df1efb6.js"><link rel="prefetch" href="/documentation/assets/js/33.b710a017.js"><link rel="prefetch" href="/documentation/assets/js/34.1e072afa.js"><link rel="prefetch" href="/documentation/assets/js/35.e8e2afeb.js"><link rel="prefetch" href="/documentation/assets/js/36.f73a5c14.js"><link rel="prefetch" href="/documentation/assets/js/37.ef49c5d6.js"><link rel="prefetch" href="/documentation/assets/js/38.a193814a.js"><link rel="prefetch" href="/documentation/assets/js/39.6c75afe5.js"><link rel="prefetch" href="/documentation/assets/js/4.6f67b7ab.js"><link rel="prefetch" href="/documentation/assets/js/40.34becb2c.js"><link rel="prefetch" href="/documentation/assets/js/41.1383b113.js"><link rel="prefetch" href="/documentation/assets/js/42.b51fdf73.js"><link rel="prefetch" href="/documentation/assets/js/43.3db4c845.js"><link rel="prefetch" href="/documentation/assets/js/44.3de05fda.js"><link rel="prefetch" href="/documentation/assets/js/45.4a12dfbf.js"><link rel="prefetch" href="/documentation/assets/js/46.62780b5d.js"><link rel="prefetch" href="/documentation/assets/js/47.7a16e504.js"><link rel="prefetch" href="/documentation/assets/js/48.7153a5d0.js"><link rel="prefetch" href="/documentation/assets/js/49.01e32cc4.js"><link rel="prefetch" href="/documentation/assets/js/5.fa70b855.js"><link rel="prefetch" href="/documentation/assets/js/50.3639c671.js"><link rel="prefetch" href="/documentation/assets/js/51.eef16439.js"><link rel="prefetch" href="/documentation/assets/js/53.9f6bb087.js"><link rel="prefetch" href="/documentation/assets/js/54.2ed4ea1a.js"><link rel="prefetch" href="/documentation/assets/js/55.7792b98f.js"><link rel="prefetch" href="/documentation/assets/js/56.3cf86db1.js"><link rel="prefetch" href="/documentation/assets/js/57.b90e7351.js"><link rel="prefetch" href="/documentation/assets/js/58.cf016679.js"><link rel="prefetch" href="/documentation/assets/js/59.202d9689.js"><link rel="prefetch" href="/documentation/assets/js/6.fe49d135.js"><link rel="prefetch" href="/documentation/assets/js/60.86826ec0.js"><link rel="prefetch" href="/documentation/assets/js/61.462d5ca1.js"><link rel="prefetch" href="/documentation/assets/js/62.841a9a8d.js"><link rel="prefetch" href="/documentation/assets/js/63.58e26583.js"><link rel="prefetch" href="/documentation/assets/js/64.67d9e7a0.js"><link rel="prefetch" href="/documentation/assets/js/65.019def51.js"><link rel="prefetch" href="/documentation/assets/js/66.8121e48e.js"><link rel="prefetch" href="/documentation/assets/js/67.bea5c5b6.js"><link rel="prefetch" href="/documentation/assets/js/68.a71723b2.js"><link rel="prefetch" href="/documentation/assets/js/69.96e95cdd.js"><link rel="prefetch" href="/documentation/assets/js/7.e9f226de.js"><link rel="prefetch" href="/documentation/assets/js/70.68a1c53f.js"><link rel="prefetch" href="/documentation/assets/js/8.d8e70a21.js"><link rel="prefetch" href="/documentation/assets/js/9.aff7f0c2.js">
    <link rel="stylesheet" href="/documentation/assets/css/0.styles.35b86ec1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentation/" class="home-link router-link-active"><img src="/documentation/logo.svg" alt="Alpha" class="logo"> <span class="site-name can-hide">Alpha</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/alpha.html" class="nav-link">
  Agoric Alpha
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link router-link-active">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/wallet-api.html" class="nav-link">
  Wallet API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/documentation/distributed-programming.html" class="nav-link">
  JS Distributed Programming
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link router-link-active">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link router-link-active">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/alpha.html" class="nav-link">
  Agoric Alpha
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/agoric-cli-guide.html" class="nav-link">
  Agoric CLI
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link router-link-active">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/wallet-api.html" class="nav-link">
  Wallet API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="/documentation/distributed-programming.html" class="nav-link">
  JS Distributed Programming
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link router-link-active">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link router-link-active">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/documentation/getting-started/intro-zoe.html" class="sidebar-link">Zoe Introduction</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/" class="sidebar-heading clickable router-link-active"><span>Zoe Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/contracts/" class="sidebar-heading clickable router-link-active open"><span>Zoe Contracts</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentation/zoe/guide/contracts/automatic-refund.html" class="sidebar-link">Automatic Refund</a></li><li><a href="/documentation/zoe/guide/contracts/atomic-swap.html" class="sidebar-link">Atomic Swap</a></li><li><a href="/documentation/zoe/guide/contracts/autoswap.html" aria-current="page" class="active sidebar-link">Autoswap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/zoe/guide/contracts/autoswap.html#the-autoswap-api" class="sidebar-link">The Autoswap API</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/guide/contracts/autoswap.html#initialization" class="sidebar-link">Initialization</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/guide/contracts/autoswap.html#adding-liquidity-to-the-pool" class="sidebar-link">Adding liquidity to the pool</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/guide/contracts/autoswap.html#making-a-swap-offer" class="sidebar-link">Making a swap offer</a></li><li class="sidebar-sub-header"><a href="/documentation/zoe/guide/contracts/autoswap.html#removing-liquidity" class="sidebar-link">Removing Liquidity</a></li></ul></li><li><a href="/documentation/zoe/guide/contracts/barter-exchange.html" class="sidebar-link">Barter Exchange</a></li><li><a href="/documentation/zoe/guide/contracts/covered-call.html" class="sidebar-link">Covered Call</a></li><li><a href="/documentation/zoe/guide/contracts/escrow-to-vote.html" class="sidebar-link">Escrow To Vote</a></li><li><a href="/documentation/zoe/guide/contracts/fundedCallSpread.html" class="sidebar-link">Funded Call Spread</a></li><li><a href="/documentation/zoe/guide/contracts/loan.html" class="sidebar-link">Loan</a></li><li><a href="/documentation/zoe/guide/contracts/mint-and-sell-nfts.html" class="sidebar-link">Mint and Sell NFTs</a></li><li><a href="/documentation/zoe/guide/contracts/mint-payments.html" class="sidebar-link">Mint Payments</a></li><li><a href="/documentation/zoe/guide/contracts/multipoolAutoswap.html" class="sidebar-link">Multipool Autoswap</a></li><li><a href="/documentation/zoe/guide/contracts/oracle.html" class="sidebar-link">The Low-level Oracle Query Contract</a></li><li><a href="/documentation/zoe/guide/contracts/otc-desk.html" class="sidebar-link">OTC Desk Contract</a></li><li><a href="/documentation/zoe/guide/contracts/pricedCallSpread.html" class="sidebar-link">Priced Call Spread</a></li><li><a href="/documentation/zoe/guide/contracts/second-price-auction.html" class="sidebar-link">Second-price auction</a></li><li><a href="/documentation/zoe/guide/contracts/sell-items.html" class="sidebar-link">Sell Items</a></li><li><a href="/documentation/zoe/guide/contracts/simple-exchange.html" class="sidebar-link">Simple Exchange</a></li><li><a href="/documentation/zoe/guide/contracts/use-obj-example.html" class="sidebar-link">Use Object Example</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/api/" class="sidebar-heading clickable"><span>Zoe API</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/documentation/zoe/roadmap/" class="sidebar-link">Zoe Roadmap</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="autoswap"><a href="#autoswap" class="header-anchor">#</a> Autoswap</h1> <div class="zoe-version">
    Zoe Alpha Release v0.8.1. Last updated
    2020-9-15.
</div> <h5 id="view-the-code-on-github-last-updated-2020-9-14"><a href="#view-the-code-on-github-last-updated-2020-9-14" class="header-anchor">#</a> <a href="https://github.com/Agoric/agoric-sdk/blob/2a8b0fc2ece7344604bcc23b295367cd871f6995/packages/zoe/src/contracts/autoswap.js" target="_blank" rel="noopener noreferrer">View the code on Github<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (Last updated: 2020-9-14)</h5> <h5 id="view-all-contracts-on-github"><a href="#view-all-contracts-on-github" class="header-anchor">#</a> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe/src/contracts" target="_blank" rel="noopener noreferrer">View all contracts on Github<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h5> <p>Autoswap is a contract that maintains a pool of assets (the 'liquidity pool') that
can always trade against any incoming offer. It can do this because the
<a href="https://medium.com/scalar-capital/uniswap-a-unique-exchange-f4ef44f807bf" target="_blank" rel="noopener noreferrer">constant product rule<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
ensures that it will never run out of assets and will always be able to quote a
price it can trade at.</p> <p>This contract follows the design of <a href="https://uniswap.org/" target="_blank" rel="noopener noreferrer">UniSwap<svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, with a single
pool. This means any autoswap installation can make exchanges between two
issuers. <code>multipoolAutoswap</code> generalizes this to many pools, all of which share a
common intermediate pool. We make this single autoswap contract available because it's
simpler and therefore easier to read. We expect all practical usage to migrate to
multipoolAutoswap.</p> <h2 id="the-autoswap-api"><a href="#the-autoswap-api" class="header-anchor">#</a> The Autoswap API</h2> <p>When the contract is instantiated, its two tokens (<code>Central</code> and <code>Secondary</code>) are
specified in the <code>issuerKeywordRecord</code>. There is no behavioral difference between the
two when trading; the names were chosen for consistency with multipoolAutoswap. When
trading, use the keywords <code>In</code> and <code>Out</code> to specify the amount to be paid in and the
amount to be received.</p> <p>When adding or removing liquidity, the amounts deposited must be in proportion to the
current balances in the pool. The amount of the <code>Central</code> asset is used as the
basis. The <code>Secondary</code> assets must be added in proportion.  If less <code>Secondary</code> is
provided than required, we refuse the offer. If more is
provided than is required, we return the excess.</p> <p>Before trading can take place, someone must add liquidity using
<code>makeAddLiquidityInvitation()</code>. Separate invitations are available that distinguish
adding and removing liquidity, and swaps with input and output specified. Other API
operations support price checks and checking the size of the liquidity pool.</p> <p>The <code>swap()</code> operation requires either the input amount or the output amount to be
specified. <code>makeSwapInInvitation()</code> treats the give amount as definitive, while
<code>makeSwapOutInvitation()</code> honors the want amount. With swapIn, a want amount can be
specified, and if the offer can't be satisfied, the offer will be refunded. Similarly
with swapOut, the want amount will be satisfied if possible. If more is provided as the
give amount than necessary, the excess will be refunded. If not enough is provided, the
offer will be refunded.</p> <p>The <code>publicFacet</code> has methods to</p> <ul><li>get price quotes
<ul><li>for a specified input: <code>getInputPrice()</code></li> <li>for a specified output: <code>getOutputPrice()</code></li></ul></li> <li>make new invitations
<ul><li>swap with input specified:<code>makeSwapInInvitation()</code></li> <li>swap with output specified:<code>makeSwapOutInvitation()</code></li> <li>add liquidity: <code>makeAddLiquidityInvitation()</code></li> <li>remove liquidity: <code>makeRemoveLiquidityInvitation()</code></li></ul></li> <li>query about the state of liquidity pools
<ul><li>the current outstanding liquidity: <code>getLiquiditySupply()</code></li> <li>the current balances in the pool: <code>getPoolAllocation()</code></li></ul></li> <li>get the shared liquidity issuer
<ul><li>Liquidity issuer: <code>getLiquidityIssuer()</code></li></ul></li></ul> <h2 id="initialization"><a href="#initialization" class="header-anchor">#</a> Initialization</h2> <p>When someone creates an instance of the Autoswap code, they receive only the public
facet. The creator has no special access or privileges.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> issuerKeywordRecord <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  Central<span class="token operator">:</span> moolaIssuer<span class="token punctuation">,</span>
  Secondary<span class="token operator">:</span> simoleanIssuer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> publicFacet <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>zoe<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startInstance</span><span class="token punctuation">(</span>
  autoswapInstallation<span class="token punctuation">,</span>
  issuerKeywordRecord<span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="adding-liquidity-to-the-pool"><a href="#adding-liquidity-to-the-pool" class="header-anchor">#</a> Adding liquidity to the pool</h2> <p>We can contribute to the Autoswap liquidity pool by making an offer using an
invitation to add liquidity. For instance, let's say that Alice creates a proposal
with the associated payments of moola and simoleans and escrows them. At the time she
creates the pool, the market price is 2 moola for 1 simolean, so that's the rate she
sets up.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> moola <span class="token operator">=</span> moolaAmountMath<span class="token punctuation">.</span>make<span class="token punctuation">;</span>
<span class="token keyword">const</span> simoleans <span class="token operator">=</span> simoleanAmountMath<span class="token punctuation">.</span>make<span class="token punctuation">;</span>
<span class="token keyword">const</span> liquidity <span class="token operator">=</span> liquidityAmountMath<span class="token punctuation">.</span>make<span class="token punctuation">;</span>
<span class="token keyword">const</span> liquidityIssuer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>zoe<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLiquidityIssuer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> aliceLiquidityPurse <span class="token operator">=</span> <span class="token constant">E</span><span class="token punctuation">(</span>liquidityIssuer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeEmptyPurse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aliceProposal <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  give<span class="token operator">:</span> <span class="token punctuation">{</span>
    Central<span class="token operator">:</span> <span class="token function">moola</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Secondary<span class="token operator">:</span> <span class="token function">simolean</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  want<span class="token operator">:</span> <span class="token punctuation">{</span> Liquidity<span class="token operator">:</span> <span class="token function">liquidity</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  exit<span class="token operator">:</span> <span class="token punctuation">{</span> onDemand<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> alicePayments <span class="token operator">=</span> <span class="token punctuation">{</span>
  Central<span class="token operator">:</span> aliceMoolaPayment<span class="token punctuation">,</span>
  Secondary<span class="token operator">:</span> aliceSimoleanPayment
<span class="token punctuation">}</span>

<span class="token keyword">const</span> seat <span class="token operator">=</span>
  <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>zoe<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>addLiquidityInvitation<span class="token punctuation">,</span> aliceProposal<span class="token punctuation">,</span> alicePayments<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> liquidityPayment <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>seat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPayout</span><span class="token punctuation">(</span><span class="token string">'Liquidity'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token constant">E</span><span class="token punctuation">(</span>aliceLiquidityPurse<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deposit</span><span class="token punctuation">(</span>liquidityPayment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="making-a-swap-offer"><a href="#making-a-swap-offer" class="header-anchor">#</a> Making a swap offer</h2> <p>Let's say that Bob wants to use the moola-to-simolean Autoswap to sell 2 moola for
simolean. First he uses the <code>publicFacet</code> to check the price:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> simoleanAmounts <span class="token operator">=</span> <span class="token constant">E</span><span class="token punctuation">(</span>publicFacet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputPrice</span><span class="token punctuation">(</span><span class="token function">moola</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> simoleanBrand<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>He learns that the current value of 2 moola is 1 simolean. Because other people may
make offers before Bob does, he can't rely on this price lasting. However, he can make
his offer conditional on getting at least 1 simolean back. If the price has moved
against him, he will get his money back:</p> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> bobMoolaForSimProposal <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  want<span class="token operator">:</span> <span class="token punctuation">{</span> Secondary<span class="token operator">:</span> <span class="token function">simoleans</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  give<span class="token operator">:</span> <span class="token punctuation">{</span> Central<span class="token operator">:</span> <span class="token function">moola</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Bob uses the <code>publicFacet</code> to get an invitation for the swap he wants to make.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> swapInvitation <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>publicFacet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeSwapInInvitation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>He escrows 2 moola with Zoe and uses his invitation to make an offer:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> bobMoolaPayment <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span> Central<span class="token operator">:</span> bobMoolaPayment <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> swapSeat <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>zoe<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>swapInvitation<span class="token punctuation">,</span> bobMoolaProposal<span class="token punctuation">,</span> bobMoolaPayment<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Now Bob can get his payout:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> bobMoolaPayout <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>swapSeat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPayout</span><span class="token punctuation">(</span><span class="token string">'Central'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> bobSimoleanPayout <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>swapSeat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPayout</span><span class="token punctuation">(</span><span class="token string">'Secondary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="removing-liquidity"><a href="#removing-liquidity" class="header-anchor">#</a> Removing Liquidity</h2> <p>When Alice wants to remove liquidity to get moola and simoleans back, she makes a new
proposal and escrows a payment of liquidity tokens:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> aliceRemoveLiquidityInvitation <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>publicFacet<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">makeRemoveLiquidityInvitation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aliceRemoveLiquidityProposal <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  give<span class="token operator">:</span> <span class="token punctuation">{</span> Liquidity<span class="token operator">:</span> <span class="token function">liquidity</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aliceSeat <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>zoe<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">offer</span><span class="token punctuation">(</span>
  aliceRemoveLiquidityInvitation<span class="token punctuation">,</span>
  aliceRemoveLiquidityProposal<span class="token punctuation">,</span>
  <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span> Liquidity<span class="token operator">:</span> <span class="token constant">E</span><span class="token punctuation">(</span>aliceLiquidityPurse<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token function">liquidity</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> aliceMoolaPayout <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>aliceSeat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPayout</span><span class="token punctuation">(</span><span class="token string">'Central'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> aliceSimoleanPayout <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">E</span><span class="token punctuation">(</span>aliceSeat<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPayout</span><span class="token punctuation">(</span><span class="token string">'Secondary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Agoric/documentation/edit/main/main/zoe/guide/contracts/autoswap.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-labelledby="outbound-link-title" role="img" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><title id="outbound-link-title">(opens new window)</title> <path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/21/2021, 9:54:20 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documentation/zoe/guide/contracts/atomic-swap.html" class="prev">
        Atomic Swap
      </a></span> <span class="next"><a href="/documentation/zoe/guide/contracts/barter-exchange.html">
        Barter Exchange
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documentation/assets/js/app.bbb45119.js" defer></script><script src="/documentation/assets/js/2.58eb442a.js" defer></script><script src="/documentation/assets/js/52.d1b94f53.js" defer></script><script src="/documentation/assets/js/18.2e7dec5a.js" defer></script>
  </body>
</html>
