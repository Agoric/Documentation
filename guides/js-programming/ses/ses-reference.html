<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SES Reference | Beta</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/documentation/favicon-full.ico">
    <style type="text/css">
    .two-col-table td {
        width: 50%;
    }
    .two-col-table table {
        table-layout: fixed;
    }</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-118217811-1"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-118217811-1'); </script>
    <script>
    const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://agoric.com");
      homeEl.setAttribute("onclick", "return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://agoric.com';return false;");
      clearInterval(logoUrlChanger);
    }
   }, 1000) </script>
    <meta name="description" content="Build, deploy and operate dApps and DeFi markets.">
    
    <link rel="preload" href="/documentation/assets/css/0.styles.3032228c.css" as="style"><link rel="preload" href="/documentation/assets/js/app.da687f13.js" as="script"><link rel="preload" href="/documentation/assets/js/2.055035d6.js" as="script"><link rel="preload" href="/documentation/assets/js/56.8a687967.js" as="script"><link rel="prefetch" href="/documentation/assets/js/10.605dc77e.js"><link rel="prefetch" href="/documentation/assets/js/11.5da275b9.js"><link rel="prefetch" href="/documentation/assets/js/12.e462e083.js"><link rel="prefetch" href="/documentation/assets/js/13.5d1f0876.js"><link rel="prefetch" href="/documentation/assets/js/14.fa0ecac6.js"><link rel="prefetch" href="/documentation/assets/js/15.76ec7550.js"><link rel="prefetch" href="/documentation/assets/js/16.4dde13c7.js"><link rel="prefetch" href="/documentation/assets/js/17.ac5057b1.js"><link rel="prefetch" href="/documentation/assets/js/18.e5d573f0.js"><link rel="prefetch" href="/documentation/assets/js/19.f6159705.js"><link rel="prefetch" href="/documentation/assets/js/20.ba9a8c81.js"><link rel="prefetch" href="/documentation/assets/js/21.2bf0bcc8.js"><link rel="prefetch" href="/documentation/assets/js/22.3c41c5fe.js"><link rel="prefetch" href="/documentation/assets/js/23.3ce7e6cd.js"><link rel="prefetch" href="/documentation/assets/js/24.8c188fe2.js"><link rel="prefetch" href="/documentation/assets/js/25.dfc3a7e2.js"><link rel="prefetch" href="/documentation/assets/js/26.e44ec958.js"><link rel="prefetch" href="/documentation/assets/js/27.eb56a11b.js"><link rel="prefetch" href="/documentation/assets/js/28.2c771e17.js"><link rel="prefetch" href="/documentation/assets/js/29.85d5b3f2.js"><link rel="prefetch" href="/documentation/assets/js/3.63afc3fb.js"><link rel="prefetch" href="/documentation/assets/js/30.11a3f04c.js"><link rel="prefetch" href="/documentation/assets/js/31.e0b02dd4.js"><link rel="prefetch" href="/documentation/assets/js/32.8be30b6e.js"><link rel="prefetch" href="/documentation/assets/js/33.e54a111c.js"><link rel="prefetch" href="/documentation/assets/js/34.abf68cfb.js"><link rel="prefetch" href="/documentation/assets/js/35.4905b9e8.js"><link rel="prefetch" href="/documentation/assets/js/36.77a11032.js"><link rel="prefetch" href="/documentation/assets/js/37.33c60f41.js"><link rel="prefetch" href="/documentation/assets/js/38.1d63897e.js"><link rel="prefetch" href="/documentation/assets/js/39.dd769763.js"><link rel="prefetch" href="/documentation/assets/js/4.8df52773.js"><link rel="prefetch" href="/documentation/assets/js/40.b9ed46db.js"><link rel="prefetch" href="/documentation/assets/js/41.195c2fed.js"><link rel="prefetch" href="/documentation/assets/js/42.715dd231.js"><link rel="prefetch" href="/documentation/assets/js/43.03689eb2.js"><link rel="prefetch" href="/documentation/assets/js/44.eb0ba454.js"><link rel="prefetch" href="/documentation/assets/js/45.e505a54c.js"><link rel="prefetch" href="/documentation/assets/js/46.e51f13d5.js"><link rel="prefetch" href="/documentation/assets/js/47.82d4529a.js"><link rel="prefetch" href="/documentation/assets/js/48.8077f294.js"><link rel="prefetch" href="/documentation/assets/js/49.ff94e9b9.js"><link rel="prefetch" href="/documentation/assets/js/5.a4c90d63.js"><link rel="prefetch" href="/documentation/assets/js/50.329a4a22.js"><link rel="prefetch" href="/documentation/assets/js/51.ffdf1ddb.js"><link rel="prefetch" href="/documentation/assets/js/52.6c91e033.js"><link rel="prefetch" href="/documentation/assets/js/53.d73e87c6.js"><link rel="prefetch" href="/documentation/assets/js/54.a0543c47.js"><link rel="prefetch" href="/documentation/assets/js/55.2d6c3f6b.js"><link rel="prefetch" href="/documentation/assets/js/57.e8142a9a.js"><link rel="prefetch" href="/documentation/assets/js/58.4b1eb2c0.js"><link rel="prefetch" href="/documentation/assets/js/59.801d9e70.js"><link rel="prefetch" href="/documentation/assets/js/6.71d1ebbc.js"><link rel="prefetch" href="/documentation/assets/js/60.7871118c.js"><link rel="prefetch" href="/documentation/assets/js/61.c0071f2f.js"><link rel="prefetch" href="/documentation/assets/js/62.44a5d526.js"><link rel="prefetch" href="/documentation/assets/js/63.140fafdc.js"><link rel="prefetch" href="/documentation/assets/js/64.e3e1337d.js"><link rel="prefetch" href="/documentation/assets/js/65.7fa0218b.js"><link rel="prefetch" href="/documentation/assets/js/66.832d7f9e.js"><link rel="prefetch" href="/documentation/assets/js/67.53f93283.js"><link rel="prefetch" href="/documentation/assets/js/68.c7a0635a.js"><link rel="prefetch" href="/documentation/assets/js/69.4000f7c9.js"><link rel="prefetch" href="/documentation/assets/js/7.4c1fadb9.js"><link rel="prefetch" href="/documentation/assets/js/70.f8fc51b7.js"><link rel="prefetch" href="/documentation/assets/js/71.b044f934.js"><link rel="prefetch" href="/documentation/assets/js/72.6140ad96.js"><link rel="prefetch" href="/documentation/assets/js/73.13329aae.js"><link rel="prefetch" href="/documentation/assets/js/74.de457219.js"><link rel="prefetch" href="/documentation/assets/js/75.54fe6f01.js"><link rel="prefetch" href="/documentation/assets/js/76.5659e85d.js"><link rel="prefetch" href="/documentation/assets/js/77.57a2e97b.js"><link rel="prefetch" href="/documentation/assets/js/78.d47996b6.js"><link rel="prefetch" href="/documentation/assets/js/79.3fced6e1.js"><link rel="prefetch" href="/documentation/assets/js/8.8d1474ce.js"><link rel="prefetch" href="/documentation/assets/js/80.2bfb7526.js"><link rel="prefetch" href="/documentation/assets/js/81.25589c5a.js"><link rel="prefetch" href="/documentation/assets/js/82.488825da.js"><link rel="prefetch" href="/documentation/assets/js/83.46a3b958.js"><link rel="prefetch" href="/documentation/assets/js/84.a807202d.js"><link rel="prefetch" href="/documentation/assets/js/85.e80307ee.js"><link rel="prefetch" href="/documentation/assets/js/86.7ebcc02d.js"><link rel="prefetch" href="/documentation/assets/js/87.9aecbc10.js"><link rel="prefetch" href="/documentation/assets/js/88.b7ef1a4e.js"><link rel="prefetch" href="/documentation/assets/js/89.a1df23c9.js"><link rel="prefetch" href="/documentation/assets/js/9.1992c59f.js"><link rel="prefetch" href="/documentation/assets/js/90.dc917323.js"><link rel="prefetch" href="/documentation/assets/js/91.c661fe84.js"><link rel="prefetch" href="/documentation/assets/js/92.56e89761.js"><link rel="prefetch" href="/documentation/assets/js/93.653e0d6f.js"><link rel="prefetch" href="/documentation/assets/js/94.a361a519.js"><link rel="prefetch" href="/documentation/assets/js/95.293f2fe4.js">
    <link rel="stylesheet" href="/documentation/assets/css/0.styles.3032228c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentation/" class="home-link router-link-active"><img src="/documentation/logo.svg" alt="Beta" class="logo"> <span class="site-name can-hide">Beta</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link router-link-active">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link router-link-active">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/documentation/getting-started/" class="sidebar-link">Documentation Guide</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/agoric-cli/" class="sidebar-heading clickable"><span>Agoric CLI</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/ertp/guide/" class="sidebar-heading clickable"><span>ERTP Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/" class="sidebar-heading clickable"><span>Zoe Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/wallet/" class="sidebar-heading clickable"><span>Wallet</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/js-programming/" class="sidebar-heading clickable router-link-active"><span>JavaScript Programming</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/js-programming/ses/" class="sidebar-heading clickable router-link-active open"><span>SES</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentation/guides/js-programming/ses/ses-guide.html" class="sidebar-link">SES Guide</a></li><li><a href="/documentation/guides/js-programming/ses/ses-reference.html" aria-current="page" class="active sidebar-link">SES Reference</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#using-ses-with-your-code" class="sidebar-link">Using SES with your code</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#removed-by-ses-summary" class="sidebar-link">Removed by SES summary</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#added-changed-by-ses-summary" class="sidebar-link">Added/Changed by SES summary</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#lockdown" class="sidebar-link">lockdown()</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#lockdown-and-harden" class="sidebar-link">lockdown() and harden()</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#lockdown-options" class="sidebar-link">lockdown Options</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#default-safe-settings" class="sidebar-link">Default 'safe' settings</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#options-quick-reference" class="sidebar-link">Options quick reference</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#lockdown-options-2" class="sidebar-link">Lockdown options</a></li></ul></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#errortaming-options" class="sidebar-link">errorTaming Options</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#stackfiltering-options" class="sidebar-link">stackFiltering Options</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/ses/ses-reference.html#overridetaming-options" class="sidebar-link">overrideTaming Options</a></li></ul></li><li><a href="/documentation/guides/js-programming/ses/lockdown.html" class="sidebar-link">lockdown() and its Options</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/repl/" class="sidebar-heading clickable"><span>REPL</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="sidebar-link">Dynamic IBC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li><a href="/documentation/guides/chainlink-integration.html" class="sidebar-link">Chainlink Integration</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ses-reference"><a href="#ses-reference" class="header-anchor">#</a> SES Reference</h1> <p>This document describes how SES (Secure ECMAScript) affects writing Agoric JavaScript code.
It is very much a &quot;how to do something&quot; document, with little explanation about why and
how something was implemented or other background information. For that, see the more
comprehensive <a href="/documentation/guides/js-programming/ses/ses-guide.html">SES Guide</a>.</p> <h2 id="using-ses-with-your-code"><a href="#using-ses-with-your-code" class="header-anchor">#</a> Using SES with your code</h2> <p>The SES shim transforms ordinary JavaScript environments into SES environments.</p> <p>On Node.js you can import or require <code>ses</code> in either CommonJS or ECMAScript modules, then call <code>lockdown()</code>. This is a <em>shim</em>. It mutates the environment in place so any code running after the shim can assume it’s running in a SES environment. This includes the globals <code>lockdown()</code>, <code>harden()</code>, <code>Compartment</code>, and so on. For example:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;ses&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Or:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'ses'</span><span class="token punctuation">;</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To ensure a module runs in a SES environment, wrap the above code in a <code>ses-lockdown.js</code> module and import it:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'./non-ses-code-before-lockdown.js'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'./ses-lockdown.js'</span><span class="token punctuation">;</span> <span class="token comment">// calls lockdown.</span>
<span class="token keyword">import</span> <span class="token string">'./ses-code-after-lockdown.js'</span><span class="token punctuation">;</span>
</code></pre></div><p>To use SES as a script on the web, use the UMD build.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;node_modules/ses/dist/ses.umd.min.js&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><p>The full SES environment's module system requires a translating compiler. There is a much thinner SES version that just provides an evaluator Compartment. For it, use the much smaller <code>ses/lockdown</code> layer. Especially if all client code gets bundled as a script out-of-band.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token string">'ses/lockdown'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;node_modules/ses/dist/lockdown.umd.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h2 id="removed-by-ses-summary"><a href="#removed-by-ses-summary" class="header-anchor">#</a> Removed by SES summary</h2> <p>The following are missing or unusable under SES:</p> <ul><li>Most <a href="https://nodejs.org/dist/latest-v14.x/docs/api/globals.html" target="_blank" rel="noopener noreferrer">Node.js-specific global objects<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>All <a href="https://nodejs.org/dist/latest-v14.x/docs/api/" target="_blank" rel="noopener noreferrer">Node.js built-in modules<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> such as <code>http</code> and
<code>crypto</code>.</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/API" target="_blank" rel="noopener noreferrer">Features from browser environments<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> presented as names in the global scope including <code>atob</code>, <code>TextEncoder</code>, and <code>URL</code>.</li> <li>HTML comments</li> <li>Dynamic <code>import</code> expressions</li> <li>Direct evals</li></ul> <h2 id="added-changed-by-ses-summary"><a href="#added-changed-by-ses-summary" class="header-anchor">#</a> Added/Changed by SES summary</h2> <p>SES adds the following to JavaScript or changes them significantly:</p> <ul><li>console</li> <li><code>Compartment</code></li> <li><code>lockdown()</code></li> <li><code>harden()</code></li> <li><code>globalThis</code> is frozen.</li> <li>JavaScript primordials are frozen.</li></ul> <h2 id="lockdown"><a href="#lockdown" class="header-anchor">#</a> <code>lockdown()</code></h2> <p><code>lockdown()</code> tamper-proofs all of the JavaScript intrinsics, so no program can subvert their methods
(preventing some man in the middle attacks). Also, no program can use them to pass notes to parties
that haven't been expressly introduced (preventing some covert communication channels).</p> <p>Lockdown <em>freezes</em> all JavaScript defined objects accessible to any program in the realm. The frozen
accessible objects include but are not limited to:</p> <ul><li><code>globalThis</code></li> <li><code>[].__proto__</code> the array prototype, equivalent to <code>Array.prototype</code> in a pristine JavaScript environment.</li> <li><code>{}.__proto__</code> the <code>Object.prototype</code></li> <li><code>(() =&gt; {}).__proto__</code> the <code>Function.prototype</code></li> <li><code>(async () =&gt; {}).__proto__</code> the prototype of all asynchronous functions, and has no alias
in the global scope of a pristine JavaScript environment.</li> <li>The properties of any accessible object</li></ul> <p><code>lockdown()</code> also <em>tames</em> some objects, such as:</p> <ul><li>Regular expressions
<ul><li>A tamed RexExp does not have the deprecated compile method.</li></ul></li> <li>Locale methods
<ul><li>Lockdown replaces locale methods like <code>String.prototype.localeCompare()</code> with lexical
versions that do not reveal the user locale.</li></ul></li> <li>Errors
<ul><li>A tamed error does not have a V8 stack, but the console can still see the stack.</li></ul></li></ul> <p>Lockdown does not erase any powerful objects from the initial global scope. Instead,
Compartments give complete control over what powerful objects exist for client code.</p> <h2 id="lockdown-and-harden"><a href="#lockdown-and-harden" class="header-anchor">#</a> <code>lockdown()</code> and <code>harden()</code></h2> <p><code>lockdown()</code> and <code>harden()</code> essentially do the same thing; freeze objects so their
properties cannot be changed. You can only interact with frozen objects through
their methods. Their differences are what objects you use them on, and when you use them.</p> <p><code>lockdown()</code> <strong>must</strong> be called first. It hardens JavaScript's built-in <em>primordials</em>
(implicitly shared global objects) and enables <code>harden()</code>. Calling <code>harden()</code>
before <code>lockdown()</code> executes throws an error.</p> <p><code>lockdown()</code> works on objects created by the JavaScript language itself as part of
its definition. Use <code>harden()</code> to freeze objects created by your JavaScript code
after <code>lockdown()</code>was called.</p> <h2 id="lockdown-options"><a href="#lockdown-options" class="header-anchor">#</a> <code>lockdown</code> Options</h2> <h3 id="default-safe-settings"><a href="#default-safe-settings" class="header-anchor">#</a> Default <code>'safe'</code> settings</h3> <p>All four of these safety-relevant options default to <code>'safe'</code> if omitted
from a call to <code>lockdown()</code>. Their other possible value is <code>'unsafe'</code>.</p> <ul><li><code>regExpTaming</code></li> <li><code>localeTaming</code></li> <li><code>consoleTaming</code></li> <li><code>errorTaming</code></li></ul> <p>The tradeoff is safety vs compatibility with existing code. However, much legacy
JavaScript code does run under SES, even if both not written to do so and with all
the options set to <code>'safe'</code>. Only consider an <code>'unsafe'</code> value if you both need it
and can evaluate its risks.</p> <h3 id="options-quick-reference"><a href="#options-quick-reference" class="header-anchor">#</a> Options quick reference</h3> <p>This section provides a quick usage reference for <code>lockdown()</code>'s options, their possible
values, and their usage. Each is described in more detail in their individual sections
below.</p> <table><tbody><tr><td><center><b>Option</b></center></td> <td><center><b>Values</b></center></td> <td><center><b>Functionality</b></center></td></tr> <tr><td><code>regExpTaming</code></td> <td><code>'safe'</code> (default) or <code>'unsafe'</code></td> <td><code>'safe'</code> disables all <code>RegExp.*</code> methods,<br> <code>'unsafe'</code> disables all but <code>RegExp.prototype.compile()</code></td></tr> <tr><td><code>localeTaming</code></td> <td><code>'safe'</code> (default) or <code>'unsafe'</code></td> <td><code>'safe'</code> aliases <code>toLocaleString()</code> to <code>toString()</code>, etc.,<br> <code>'unsafe'</code> keeps JavaScript locale methods as is</td></tr> <tr><td><code>consoleTaming</code></td> <td><code>'safe'</code> (default) or <code>'unsafe'</code></td> <td><code>'safe'</code> wraps start console to show deep stacks,<br> <code>'unsafe'</code> uses the original start console.</td></tr> <tr><td><code>errorTaming</code></td> <td><code>'safe'</code> (default) or <code>'unsafe'</code></td> <td><code>'safe'</code> denies unprivileged stacks access,<br> <code>'unsafe'</code> makes stacks also available by <code>errorInstance.stackkeeps()</code>.</td></tr> <tr><td><code>stackFiltering</code></td> <td><code>'concise'</code> (default) or <code>'verbose'</code></td> <td><code>'concise'</code> preserves important deep stack info,<br> <code>'verbose'</code> console shows full deep stacks</td></tr> <tr><td><code>overrideTaming</code></td> <td><code>'moderate'</code> (default) or <code>'min'</code></td> <td><code>'moderate'</code> moderates mitigations for legacy compatibility,<br> <code>'min'</code> minimal mitigations for purely modern code</td></tr></tbody></table> <h3 id="lockdown-options-2"><a href="#lockdown-options-2" class="header-anchor">#</a> Lockdown options</h3> <h4 id="regexptaming-option"><a href="#regexptaming-option" class="header-anchor">#</a> <code>regExpTaming</code> Option</h4> <p>With its default <code>'safe'</code> value, regExpTaming prevents using <code>RegExp.*()</code> methods in the locked down code.</p> <p>With its <code>'unsafe'</code> value, <code>RegExp.prototype.compile()</code> can be used in locked down code.
All other <code>RegExp.*()</code> methods are disabled.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// regExpTaming defaults to 'safe'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> regExpTaming<span class="token operator">:</span> <span class="token string">'safe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Disables all RegExp.*() methods.</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> regExpTaming<span class="token operator">:</span> <span class="token string">'unsafe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Disables all RegExp.*() methods except RegExp.prototype.compile()</span>
</code></pre></div><h4 id="localetaming-option"><a href="#localetaming-option" class="header-anchor">#</a> <code>localeTaming</code> Option</h4> <p>The default <code>'safe'</code> setting replaces each method listed below with their
corresponding non-locale-specific method. For example, <code>Object.prototype.toLocaleString()</code>
becomes another name for <code>Object.prototype.toString()</code>.</p> <ul><li><code>toLocaleString</code></li> <li><code>toLocaleDateString</code></li> <li><code>toLocaleTimeString</code></li> <li><code>toLocaleLowerCase</code></li> <li><code>toLocaleUpperCase</code></li> <li><code>localeCompare</code></li></ul> <p>The <code>'unsafe'</code> setting keeps the original behavior for compatibility at the price
of reproducibility and fingerprinting.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// localeTaming defaults to 'safe'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> localeTaming<span class="token operator">:</span> <span class="token string">'safe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Alias toLocaleString to toString, etc</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> localeTaming<span class="token operator">:</span> <span class="token string">'unsafe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Allow locale-specific behavior</span>
</code></pre></div><h4 id="consoletaming-options"><a href="#consoletaming-options" class="header-anchor">#</a> <code>consoleTaming</code> Options</h4> <p>The default <code>'safe'</code> option actually expands what you would expect from <code>console</code>'s logging
output. It will show information from the <code>assert</code> package and error objects.
Errors can report more diagnostic information that should be hidden from other objects. See
the <a href="https://github.com/Agoric/SES-shim/blob/master/packages/ses/src/error/README.md" target="_blank" rel="noopener noreferrer">error README<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
for an in depth explanation of this.</p> <p>The <code>'unsafe'</code> setting leaves the original <code>console</code> in place. The <code>assert</code> package
and error objects continue to work, but the <code>console</code> logging output will not
show this extra information. <code>'unsafe'</code> does <strong>not</strong> remove any additional <code>console</code>
methods beyond its de facto &quot;standards&quot;. Since we do not know if these
methods violate OCap security, we should assume they are unsafe. A raw <code>console</code>
object should only be handled by very trustworthy code.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// consoleTaming defaults to 'safe'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> consoleTaming<span class="token operator">:</span> <span class="token string">'safe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Wrap start console to show deep stacks</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> consoleTaming<span class="token operator">:</span> <span class="token string">'unsafe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Leave original start console in place</span>
</code></pre></div><h2 id="errortaming-options"><a href="#errortaming-options" class="header-anchor">#</a> <code>errorTaming</code> Options</h2> <p>The <code>errorTaming</code> default <code>'safe'</code> setting makes the stack trace inaccessible
from error instances alone. It does this on v8 engines (Chrome, Brave, Node).
Note that it is <strong>not</strong> hidden on other engines, leaving an information
leak available. It reveals information only as a powerless string.</p> <p>In JavaScript the stack is only available via <code>err.stack</code>, so some
development tools assume it is there. When the information leak is tolerable,
the <code>'unsafe'</code> setting preserves <code>err.stack</code>'s filtered stack information.</p> <p><code>errorTaming</code> does not affect the <code>Error</code> constructor's safety.
After calling <code>lockdown</code>, the tamed <code>Error</code> constructor in the
start compartment follows OCap rules. Under v8 it emulates most of the
magic powers of the v8 <code>Error</code> constructor—those consistent with the
discourse level of the proposed <code>getStack</code>. In all cases, the <code>Error</code>
constructor shared by all other compartments is both safe and powerless.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// errorTaming defaults to 'safe'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> errorTaming<span class="token operator">:</span> <span class="token string">'safe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Deny unprivileged access to stacks, if possible</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> errorTaming<span class="token operator">:</span> <span class="token string">'unsafe'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Stacks also available by errorInstance.stack</span>
</code></pre></div><h2 id="stackfiltering-options"><a href="#stackfiltering-options" class="header-anchor">#</a> <code>stackFiltering</code> Options</h2> <p><code>stackFiltering</code> trades off stronger stack traceback filtering to
minimize distractions vs completeness for tracking down bugs in
obscure places.</p> <p>The default <code>'concise'</code> setting removes &quot;noise&quot; from the full distributed
stack traces, in particularly artifacts from low level infrastructure. It
only works on v8 engines.</p> <p>With the <code>'verbose'</code> setting, the <code>console</code> displays the full raw stack
information for each level of the &quot;deep stack&quot;, tracing back through the
<a href="https://github.com/tc39/proposal-eventual-send" target="_blank" rel="noopener noreferrer">eventually sent messages<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
from other turns of the event loop. This makes JavaScript's already voluminous
error stacks even more so. However, this is sometimes useful for finding bugs
in low level infrastructure.</p> <p>Both settings are safe. Stack information will
or will not be available from error objects according to the <code>errorTaming</code>
option and the platform error behavior.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// stackFiltering defaults to 'concise'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stackFiltering<span class="token operator">:</span> <span class="token string">'concise'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Preserve important deep stack info</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stackFiltering<span class="token operator">:</span> <span class="token string">'verbose'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Console shows full deep stacks</span>
</code></pre></div><h2 id="overridetaming-options"><a href="#overridetaming-options" class="header-anchor">#</a> <code>overrideTaming</code> Options</h2> <p>The <code>overrideTaming</code> option trades off better code
compatibility vs better tool compatibility.</p> <p>When starting a project, we recommend using the non-default <code>'min'</code> option to make
debugging more pleasant. You may need to reset it to the <code>'moderate'</code> default if
third-party shimming code interferes with <code>lockdown()</code>.</p> <p><code>'moderate'</code> option is intended to be fairly minimal. Expand it when you
encounter code which should run under SES but can't due to
the <a href="https://web.archive.org/web/20141230041441/http://wiki.ecmascript.org/doku.php?id=strawman:fixing_override_mistake" target="_blank" rel="noopener noreferrer">override mistake<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>,</p> <p>The <code>'min'</code> setting serves two purposes:</p> <ul><li>It enables a pleasant VSCode debugging experience.</li> <li>It helps ensure new code does not depend on anything more than enabled legacy code.</li></ul> <p>All Agoric-authored code is compatible with both settings, but
Agoric currently still pulls in some third party dependencies only compatible
with the <code>'moderate'</code> setting.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// overrideTaming defaults to 'moderate'</span>
<span class="token comment">// or</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> overrideTaming<span class="token operator">:</span> <span class="token string">'moderate'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Moderate mitigations for legacy compat</span>
<span class="token comment">// vs</span>
<span class="token function">lockdown</span><span class="token punctuation">(</span><span class="token punctuation">{</span> overrideTaming<span class="token operator">:</span> <span class="token string">'min'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Minimal mitigations for purely modern code</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Agoric/documentation/edit/main/main/guides/js-programming/ses/ses-reference.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/25/2021, 7:45:51 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documentation/guides/js-programming/ses/ses-guide.html" class="prev">
        SES Guide
      </a></span> <span class="next"><a href="/documentation/guides/js-programming/ses/lockdown.html">
        lockdown() and its Options
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documentation/assets/js/app.da687f13.js" defer></script><script src="/documentation/assets/js/2.055035d6.js" defer></script><script src="/documentation/assets/js/56.8a687967.js" defer></script>
  </body>
</html>
