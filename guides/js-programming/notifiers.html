<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Notifiers and Subscriptions | Beta</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/documentation/favicon-full.ico">
    <style type="text/css">
    .two-col-table td {
        width: 50%;
    }
    .two-col-table table {
        table-layout: fixed;
    }</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-118217811-1"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-118217811-1'); </script>
    <script>
    const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://agoric.com");
      homeEl.setAttribute("onclick", "return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://agoric.com';return false;");
      clearInterval(logoUrlChanger);
    }
   }, 1000) </script>
    <meta name="description" content="Build, deploy and operate dApps and DeFi markets.">
    
    <link rel="preload" href="/documentation/assets/css/0.styles.3032228c.css" as="style"><link rel="preload" href="/documentation/assets/js/app.68c67527.js" as="script"><link rel="preload" href="/documentation/assets/js/2.055035d6.js" as="script"><link rel="preload" href="/documentation/assets/js/52.6c91e033.js" as="script"><link rel="prefetch" href="/documentation/assets/js/10.605dc77e.js"><link rel="prefetch" href="/documentation/assets/js/11.5da275b9.js"><link rel="prefetch" href="/documentation/assets/js/12.e462e083.js"><link rel="prefetch" href="/documentation/assets/js/13.5d1f0876.js"><link rel="prefetch" href="/documentation/assets/js/14.fa0ecac6.js"><link rel="prefetch" href="/documentation/assets/js/15.aee701b6.js"><link rel="prefetch" href="/documentation/assets/js/16.a3dab194.js"><link rel="prefetch" href="/documentation/assets/js/17.ac5057b1.js"><link rel="prefetch" href="/documentation/assets/js/18.e5d573f0.js"><link rel="prefetch" href="/documentation/assets/js/19.f6159705.js"><link rel="prefetch" href="/documentation/assets/js/20.ba9a8c81.js"><link rel="prefetch" href="/documentation/assets/js/21.2bf0bcc8.js"><link rel="prefetch" href="/documentation/assets/js/22.3c41c5fe.js"><link rel="prefetch" href="/documentation/assets/js/23.3ce7e6cd.js"><link rel="prefetch" href="/documentation/assets/js/24.8c188fe2.js"><link rel="prefetch" href="/documentation/assets/js/25.dfc3a7e2.js"><link rel="prefetch" href="/documentation/assets/js/26.e44ec958.js"><link rel="prefetch" href="/documentation/assets/js/27.7554e63c.js"><link rel="prefetch" href="/documentation/assets/js/28.67acd63d.js"><link rel="prefetch" href="/documentation/assets/js/29.02f452aa.js"><link rel="prefetch" href="/documentation/assets/js/3.63afc3fb.js"><link rel="prefetch" href="/documentation/assets/js/30.b3442dad.js"><link rel="prefetch" href="/documentation/assets/js/31.062160c9.js"><link rel="prefetch" href="/documentation/assets/js/32.993f95f2.js"><link rel="prefetch" href="/documentation/assets/js/33.9d94a502.js"><link rel="prefetch" href="/documentation/assets/js/34.abf68cfb.js"><link rel="prefetch" href="/documentation/assets/js/35.4905b9e8.js"><link rel="prefetch" href="/documentation/assets/js/36.77a11032.js"><link rel="prefetch" href="/documentation/assets/js/37.33c60f41.js"><link rel="prefetch" href="/documentation/assets/js/38.fbfad97d.js"><link rel="prefetch" href="/documentation/assets/js/39.dd769763.js"><link rel="prefetch" href="/documentation/assets/js/4.8df52773.js"><link rel="prefetch" href="/documentation/assets/js/40.b9ed46db.js"><link rel="prefetch" href="/documentation/assets/js/41.195c2fed.js"><link rel="prefetch" href="/documentation/assets/js/42.753d3490.js"><link rel="prefetch" href="/documentation/assets/js/43.03689eb2.js"><link rel="prefetch" href="/documentation/assets/js/44.eb0ba454.js"><link rel="prefetch" href="/documentation/assets/js/45.d8972b95.js"><link rel="prefetch" href="/documentation/assets/js/46.6113a57d.js"><link rel="prefetch" href="/documentation/assets/js/47.82d4529a.js"><link rel="prefetch" href="/documentation/assets/js/48.8077f294.js"><link rel="prefetch" href="/documentation/assets/js/49.ff94e9b9.js"><link rel="prefetch" href="/documentation/assets/js/5.b2e241ca.js"><link rel="prefetch" href="/documentation/assets/js/50.329a4a22.js"><link rel="prefetch" href="/documentation/assets/js/51.ffdf1ddb.js"><link rel="prefetch" href="/documentation/assets/js/53.d73e87c6.js"><link rel="prefetch" href="/documentation/assets/js/54.a0543c47.js"><link rel="prefetch" href="/documentation/assets/js/55.2d6c3f6b.js"><link rel="prefetch" href="/documentation/assets/js/56.098ba4f9.js"><link rel="prefetch" href="/documentation/assets/js/57.e8142a9a.js"><link rel="prefetch" href="/documentation/assets/js/58.4b1eb2c0.js"><link rel="prefetch" href="/documentation/assets/js/59.801d9e70.js"><link rel="prefetch" href="/documentation/assets/js/6.dccef4d9.js"><link rel="prefetch" href="/documentation/assets/js/60.b4368f4f.js"><link rel="prefetch" href="/documentation/assets/js/61.c0071f2f.js"><link rel="prefetch" href="/documentation/assets/js/62.44a5d526.js"><link rel="prefetch" href="/documentation/assets/js/63.140fafdc.js"><link rel="prefetch" href="/documentation/assets/js/64.e3e1337d.js"><link rel="prefetch" href="/documentation/assets/js/65.7fa0218b.js"><link rel="prefetch" href="/documentation/assets/js/66.832d7f9e.js"><link rel="prefetch" href="/documentation/assets/js/67.59c588f3.js"><link rel="prefetch" href="/documentation/assets/js/68.7a48e676.js"><link rel="prefetch" href="/documentation/assets/js/69.84385294.js"><link rel="prefetch" href="/documentation/assets/js/7.863e7fd8.js"><link rel="prefetch" href="/documentation/assets/js/70.fb2155ed.js"><link rel="prefetch" href="/documentation/assets/js/71.5727e380.js"><link rel="prefetch" href="/documentation/assets/js/72.6140ad96.js"><link rel="prefetch" href="/documentation/assets/js/73.13329aae.js"><link rel="prefetch" href="/documentation/assets/js/74.de457219.js"><link rel="prefetch" href="/documentation/assets/js/75.a6c846f4.js"><link rel="prefetch" href="/documentation/assets/js/76.56340192.js"><link rel="prefetch" href="/documentation/assets/js/77.03ef57d7.js"><link rel="prefetch" href="/documentation/assets/js/78.d47996b6.js"><link rel="prefetch" href="/documentation/assets/js/79.ea176520.js"><link rel="prefetch" href="/documentation/assets/js/8.7ffe39f1.js"><link rel="prefetch" href="/documentation/assets/js/80.2bfb7526.js"><link rel="prefetch" href="/documentation/assets/js/81.25589c5a.js"><link rel="prefetch" href="/documentation/assets/js/82.488825da.js"><link rel="prefetch" href="/documentation/assets/js/83.d0dfe049.js"><link rel="prefetch" href="/documentation/assets/js/84.a807202d.js"><link rel="prefetch" href="/documentation/assets/js/85.265ee7ce.js"><link rel="prefetch" href="/documentation/assets/js/86.7ebcc02d.js"><link rel="prefetch" href="/documentation/assets/js/87.9aecbc10.js"><link rel="prefetch" href="/documentation/assets/js/88.4994627b.js"><link rel="prefetch" href="/documentation/assets/js/89.a1df23c9.js"><link rel="prefetch" href="/documentation/assets/js/9.1992c59f.js"><link rel="prefetch" href="/documentation/assets/js/90.c6efe952.js"><link rel="prefetch" href="/documentation/assets/js/91.c661fe84.js"><link rel="prefetch" href="/documentation/assets/js/92.56e89761.js"><link rel="prefetch" href="/documentation/assets/js/93.653e0d6f.js"><link rel="prefetch" href="/documentation/assets/js/94.b264700b.js"><link rel="prefetch" href="/documentation/assets/js/95.293f2fe4.js">
    <link rel="stylesheet" href="/documentation/assets/css/0.styles.3032228c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentation/" class="home-link router-link-active"><img src="/documentation/logo.svg" alt="Beta" class="logo"> <span class="site-name can-hide">Beta</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link router-link-active">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link router-link-active">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/documentation/getting-started/" class="sidebar-link">Documentation Guide</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/agoric-cli/" class="sidebar-heading clickable"><span>Agoric CLI</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/ertp/guide/" class="sidebar-heading clickable"><span>ERTP Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/zoe/guide/" class="sidebar-heading clickable"><span>Zoe Guide</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/wallet/" class="sidebar-heading clickable"><span>Wallet</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/js-programming/" class="sidebar-heading clickable router-link-active open"><span>JavaScript Programming</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentation/guides/js-programming/agoric-js-overview.html" class="sidebar-link">Agoric JavaScript Overview</a></li><li><a href="/documentation/guides/js-programming/ses/" class="sidebar-link">SES</a></li><li><a href="/documentation/guides/js-programming/bigint.html" class="sidebar-link">BigInt</a></li><li><a href="/documentation/guides/js-programming/vats.html" class="sidebar-link">Vats</a></li><li><a href="/documentation/guides/js-programming/far.html" class="sidebar-link">Far() and Remotable Objects</a></li><li><a href="/documentation/guides/js-programming/eventual-send.html" class="sidebar-link">Remote object communication with E()</a></li><li><a href="/documentation/guides/js-programming/notifiers.html" aria-current="page" class="active sidebar-link">Notifiers and Subscriptions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#distributed-asynchronous-iteration" class="sidebar-link">Distributed Asynchronous Iteration</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#notifierkit-and-subscriptionkit" class="sidebar-link">NotifierKit and SubscriptionKit</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#notifierkit" class="sidebar-link">NotifierKit</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#subscriptionkit" class="sidebar-link">SubscriptionKit</a></li></ul></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#methods" class="sidebar-link">Methods</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#notifiers-and-subscriptions-in-zoe" class="sidebar-link">Notifiers and Subscriptions in Zoe</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#examples" class="sidebar-link">Examples</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#subscription-example" class="sidebar-link">Subscription example</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#notifier-example" class="sidebar-link">Notifier example</a></li></ul></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#distributed-operation" class="sidebar-link">Distributed Operation</a></li><li class="sidebar-sub-header"><a href="/documentation/guides/js-programming/notifiers.html#summary" class="sidebar-link">Summary</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/guides/js-programming/ses/" class="sidebar-heading clickable"><span>SES</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/documentation/repl/" class="sidebar-heading clickable"><span>REPL</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="sidebar-link">Dynamic IBC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li><a href="/documentation/guides/chainlink-integration.html" class="sidebar-link">Chainlink Integration</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="notifiers-and-subscriptions"><a href="#notifiers-and-subscriptions" class="header-anchor">#</a> Notifiers and Subscriptions</h1> <p><em>Notifiers</em> and <em>Subscriptions</em> both let a service notify clients of state changes.
Specifically, both are abstractions for producing and consuming asynchronous
value sequences. They rely on promises to deliver a stream of messages allowing
many clients to receive notifications without the originator having to track a subscription list.
An object wanting to publish updates to interested clients makes a notifier or a
subscription available to them.</p> <p>In JavaScript, async iterations are manipulated by <code>AsyncGenerators</code>, <code>AsyncIterables</code>, and <code>AsyncIterators</code>. For an introduction to them, see <a href="https://javascript.info/async-iterators-generators" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="distributed-asynchronous-iteration"><a href="#distributed-asynchronous-iteration" class="header-anchor">#</a> Distributed Asynchronous Iteration</h2> <p>An <em>async iteration</em> is an abstract sequence of values. It consists of zero or
more <em>non-final values</em> in a fully ordered sequence, revealed asynchronously
over time. In other words, the values have a full ordering, and all consumers
see the whole sequence, or a subset of it, in the same order.</p> <p>The sequence may continue indefinitely or terminate in one of two ways:</p> <ul><li><em>Finish</em>: The async iteration successfully completes and reports any JavaScript
value as a final completion.</li> <li><em>Fail</em>: The async iteration fails and gives a reported final reason. This should be an
error object, but can be any JavaScript value.</li></ul> <p><code>Finish</code> and <code>Fail</code> are final values. To avoid confusion, for iteration values in
this doc, &quot;final&quot; and &quot;non-final&quot; just refer to position in an iteration, and not
&quot;final&quot; in the sense of the Java keyword or similar.</p> <h2 id="notifierkit-and-subscriptionkit"><a href="#notifierkit-and-subscriptionkit" class="header-anchor">#</a> <code>NotifierKit</code> and SubscriptionKit</h2> <p><code>makeNotifierKit()</code> makes an<code>{updater, notifier}</code> pair, while <code>makeSubscriptionKit()</code>
makes a similar<code>{publication, subscription}</code> pair. Each pair’s first
element (<code>updater</code> or <code>publication</code>) produces the async iteration which is then
consumed using each pair’s second element (<code>notifier</code> or <code>subscription</code>).</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> makeNotifierKit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@agoric/notifier'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> makeSubscriberKit <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@agoric/notifier'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> updater<span class="token punctuation">,</span> notifier <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">makeNotifierKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> publication<span class="token punctuation">,</span> subscription <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">makeSubscriptionKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>The key difference between the two is</p> <ul><li><code>notifiers</code> are lossy.
<ul><li>While the sequence is ordered, the consumer requests only the current value and
so may never see any values that happened between requests.</li></ul></li> <li><code>subscriptions</code> are lossless.
<ul><li>The consumer will see every value in the sequence.</li></ul></li></ul> <p>If your consumers only care about more recent states, use a <code>NotifierKit</code>.  For
consumers that need to see all the values, use a <code>SubscriptionKit</code>. Subscriptions
are often appropriate when the iteration represents a changing quantity, like a purse
balance, and its consumer is updating a UI that doesn't care about any older and stale
non-final values.</p> <p>Notifiers are appropriate when a quantity changes quickly. They only communicate
non-final values at the rate they're consumed, bounded by the network round-trip
time.  All other non-final values are never communicated. The <code>NotifierKit</code>'s
lossy nature  enables this optimization.`</p> <p><code>notifier</code> and <code>subscription</code> both implement the JavaScript <code>AsyncIterable</code> API to consume the iteration. <code>updater</code> and <code>publication</code> implement the <code>IterationObserver</code> API, as defined by Agoric (JavaScript has no standard for producing iterations). For both pairs, <code>IterationObserver</code> only produces the iteration. <code>AsyncIterable</code> consumes the iteration.</p> <p>An iteration subset may be a valid iteration. <code>NotifierKit</code> and <code>SubscriptionKit</code> are each organized around a different way of subsetting one iteration into another.</p> <h3 id="notifierkit"><a href="#notifierkit" class="header-anchor">#</a> NotifierKit</h3> <p>A <code>NotifierKit</code> producer produces iteration values with the updater using the
<code>IterationObserver</code> API. Its consumers consume iteration values via the notifier
using the <code>AsyncIterable</code> API. Each <code>NotifierKit</code> consumer iteration is a lossy sampling subset of the iteration produced by that <code>NotifierKit</code> producer. Different consumers may see different sampling subsets.</p> <p>An iteration’s sampling subset:</p> <ul><li>May omit some of the iteration’s non-final values.</li> <li>All sampling subset non-final values are:
<ul><li>In the original’s non-final values (i.e. if &quot;7&quot; is in the subset, &quot;7&quot; is in
the original).</li> <li>In the same order (i.e. if the original is order 1, 3, 8, 5, 9, the subset
is in the same order, even if missing some items; 1, 8, 5 for example,
but not 8, 1, 5).</li></ul></li> <li>The original and the subset both have the same termination value.</li></ul> <p>When a new iteration value is available, either it or a later value becomes
available on each sampling subset promptly. In other words, if value 'a' is
introduced on the producer end followed a few moments later by 'b', then all
clients  either promptly see 'a', or won't see it but will promptly see a
successor, such as 'b'. If a value is added and nothing else follows for a
while, then that value must be distributed promptly to the consumers.</p> <h3 id="subscriptionkit"><a href="#subscriptionkit" class="header-anchor">#</a> SubscriptionKit</h3> <p>Use the <code>SubscriptionKit</code> for pub-sub operations, where subscribers should see
each published value starting when the subscribe. The producer can be described
as the publisher and publishes iteration values with the publication using the
<code>IterationObserver</code> API. Subscribers consume the published iteration values with
the subscription using the <code>AsyncIterable</code> API. Since each published value is sent
to all subscribers, <code>SubscriptionKit</code> generally should not be used with rapidly
produced values.</p> <p>An iteration’s suffix subset is defined by its starting point in the original
iteration, which can be a non-final value or a termination.
The suffix subset has exactly the original iteration’s members from its starting
point to and including its termination. For example, if the original is
{ 2 5 9 13 Fail } with Fail as the termination and a starting point at 9, the
subset is { 9 13 Fail }.</p> <p>When a new value becomes available on the original iteration, it promptly becomes
available on every suffix subset whose starting point is at or before that value
So if the original is { 2 5 9 13 Fail } and 9 becomes available, 9 promptly
becomes available to any suffix subset with a starting point of 2, 5, or 9. It
does not become available to any subset starting at 13 or Fail).</p> <p>Each subscription is an <code>AsyncIterable</code> that produces any number of
<code>AsyncIterators</code>. These <code>AsyncIterators</code> are <code>SubsciptionIterators</code> which also
have a <code>subscribe()</code> method. Calling a <code>subscribe()</code> method makes a
<code>Subscription</code> whose starting point is that <code>SubscriptionIterator</code>'s current
position.</p> <h2 id="methods"><a href="#methods" class="header-anchor">#</a> Methods</h2> <p>The <code>updater</code> and <code>publication</code> both have the same three methods:</p> <ul><li><code>updateState(state)</code>
Supplies and sends out a new state to consumers. All active Promises
produced by <code>getUpdateSince()</code> are resolved to the next record.</li> <li><code>finish(finalState)</code> <ul><li>Closes the stream of state changes and supplies a final state
value to consumers.</li></ul></li> <li><code>fail(reason)</code> <ul><li>Closes the stream of state changes, indicates a failure to finish
satisfactorily, and supplies a reason for the failure to consumers. Does not provide
a next state. Instead, it causes the Promise to be rejected with the reason,
signalling that the monitored object hit an error condition.</li></ul></li></ul> <p>The <code>subscription</code> and <code>publication</code> both have this method:</p> <ul><li><code>getUpdateSince()</code>: Returns <code>{ value, updateCount }</code>.
<ul><li><p>Returns the next published value after the previously obtained value.
<code>value</code> represents the state, and the format is up to the publisher.
<code>updateCount</code> requests notification the next time there's a state change.
If the state becomes final (e.g. a seat exits), <code>updateCount</code> will be
undefined. If there's an error, the promise for the record is
rejected and there isn't a next state.</p> <p>If you call <code>getUpdateSince(oldUpdateCount)</code> with no count, or any
<code>updateCount</code> other than the most recent one, the notifier immediately
returns a promise for a record with the current state. If you call with
the most-recently generated <code>updateCount</code>, the notifier returns a promise
for the next record, which is resolved on the next state change. If you
haven't called <code>getUpdateSince()</code> before, you won't have a
previous <code>updateCount</code> to use.</p></li></ul></li></ul> <h2 id="notifiers-and-subscriptions-in-zoe"><a href="#notifiers-and-subscriptions-in-zoe" class="header-anchor">#</a> Notifiers and Subscriptions in Zoe</h2> <p>Zoe provides updates on the state of seats within a contract. The updates
from Zoe indicate changes to the allocation of a seat and seats exiting.
These are available from <code>E(userSeat).getNotifier()</code> and <code>zcfSeat.getNotifier()</code>,
which provide long-lived notifier objects associated with a particular
seat. <code>zcfSeats</code> are available within contracts while <code>userSeats</code> are accessible
from the REPL, deploy scripts, and other code outside contracts. There are no
equivalent <code>getSubscription()</code> or <code>getUpdater()</code> methods on the
seats.</p> <p>Zoe's updates for an offer show the current allocation that will be paid if the contract completes without further changes.</p> <p>Individual contracts can use notifiers and subscriptions to provide updates giving current prices or other contract-specific details.</p> <p>The following methods use or return notifiers. Click on the name to go to their
full documentation:</p> <ul><li><a href="/documentation/zoe/api/zoe-contract-facet.html#zcfseat-object"><code>ZCFSeat.getNotifier()</code></a> <ul><li>Part of the Zoe Contract Facet API, returns a notifier associated with the seat's allocation. It  provides updates on changing
allocations for this seat, and tells when the seat has been exited.</li></ul></li> <li><a href="/documentation/zoe/api/zoe.html#userseat-object"><code>UserSeat.getNotifier</code></a> <ul><li>Part of the Zoe API, returns a notifier associated with the seat. Its updates can be anything the contract wants to publish, such as
price changes, new currency pools, etc.</li></ul></li> <li><a href="/documentation/ertp/api/purse.html#purse-getcurrentamountnotifier"><code>purse.getCurrentAmountNotifier()</code></a> <ul><li>Part of the ERTP API, returns a lossy notifier for changes to this purse's balance.</li></ul></li> <li><a href="/documentation/guides/wallet/api.html#getpursesnotifier"><code>getPursesNotifier</code></a> <ul><li>Part of the Wallet API, it returns a notifier that follows changes in the purses in the Wallet.</li></ul></li> <li><a href="/documentation/guides/wallet/api.html#getoffersnotifier"><code>getOffersNotifier</code></a> <ul><li>Part of the Wallet API, it returns a notifier that follows changes to the offers received by the Wallet.</li></ul></li> <li><a href="/documentation/repl/priceAuthority.html#makequotenotifier-amountin-brandout"><code>makeQuoteNotifier(amountIn,brandOut)</code></a> <ul><li>Part of the PriceAuthority API, notifies the latest <code>PriceQuotes</code> for the given <code>amountIn</code>.</li></ul></li> <li><a href="/documentation/repl/priceAuthority.html#getpricenotifier-brandin-brandout"><code>getPriceNotifier(brandIn, brandOut)</code></a> <ul><li>Part of the PriceAuthority API, returns a notifier for the specified brands. Different PriceAuthories may issue these at very
different rates.</li></ul></li> <li><a href="/documentation/repl/timerServices.html"><code>E(home.&lt;chain or local&gt;TimerService).createNotifier(delaySecs, interval)</code></a> <ul><li>Part of the REPL's chain and local TimerServices, it creates and returns a <code>Notifier</code> object. It repeatedly delivers updates at times
that are a multiple of the passed in interval value, with the first update happening the value of <code>delaySecs</code> after the notifier is
created.</li></ul></li></ul> <h2 id="examples"><a href="#examples" class="header-anchor">#</a> Examples</h2> <h3 id="subscription-example"><a href="#subscription-example" class="header-anchor">#</a> Subscription example</h3> <p>Let’s look at a subscription example. We have three characters; Paula the publisher, and subscribers Alice and Bob. While Alice and Bob both consume Paula's published iteration, they use different tools to do so.</p> <p>First we create a publication/subscription pair with <code>makeSubscriptionKit()</code>. Paula publishes an iteration with non-final sequence 'a', 'b' and  'done' as its completion value.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> publication<span class="token punctuation">,</span> subscription <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">makeSubscriptionKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// Paula the publisher says</span>
publication<span class="token punctuation">.</span><span class="token function">updateState</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
publication<span class="token punctuation">.</span><span class="token function">updateState</span><span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
publication<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Remember, <code>SubscriptionKit</code> is lossless. It conveys all of an async iteration’s non-final values, as well as the final value.</p> <p>You can use the JavaScript <code>AsyncIterable</code> API directly, but either the JavaScript for-await-of syntax or the <code>observeIteration</code> adaptor are more convenient. Here,
Alice uses the former, and then Bob uses the latter.</p> <p>Subscriber Alice consumes the iteration using the for-await-of loop. She can see
the non-final values and whether the iteration completes or fails. She can see a
failure reason, but the for-await-of syntax does not let her see the completion
value 'done'. She can write code that only executes after the loop finishes,but
the code won’t know what the completion value actually was “done”, “completed”, or something else. This is a limitation of JavaScript's iteration, whether asynchronous or synchronous (as consumed by a for-of loop).</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">consume</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token parameter">subscription</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> val <span class="token keyword">of</span> subscription<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'non-final'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'the iteration finished'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>reason<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'the iteration failed'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">consume</span><span class="token punctuation">(</span>subscription<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// eventually prints</span>
<span class="token comment">// non-final-value a</span>
<span class="token comment">// non-final-value b</span>
<span class="token comment">// the iteration finished</span>
</code></pre></div><p>Subscriber Bob consumes using the <code>(observeIteration(asyncIterableP, iterationObserver)</code> adaptor.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token function">harden</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">updateState</span><span class="token operator">:</span> <span class="token parameter">val</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'non-final'</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">finish</span><span class="token operator">:</span> <span class="token parameter">completion</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished'</span><span class="token punctuation">,</span> completion<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span> <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'failed'</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observeIteration</span><span class="token punctuation">(</span>subscription<span class="token punctuation">,</span> observer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// eventually prints</span>
<span class="token comment">// non-final-value a</span>
<span class="token comment">// non-final-value b</span>
<span class="token comment">// finished done</span>
</code></pre></div><h3 id="notifier-example"><a href="#notifier-example" class="header-anchor">#</a> Notifier example</h3> <p><code>NotifierKit()</code> is a lossy conveyor of non-final values, but does also
losslessly convey termination. Let's say the subscription example above
started with the following instead of <code>makeSubscriberKit()</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> updater<span class="token punctuation">,</span> notifier <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">makeNotifierKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If we then renamed <code>publication</code> to <code>updater</code> and <code>subscription</code> to <code>notifier</code>
in the rest of the example, the code would still be correct and work. However,
when using a notifier, either Alice or Bob may have missed either or both of the
non-final values due to <code>NotifierKit()</code>'s lossy nature.</p> <h2 id="distributed-operation"><a href="#distributed-operation" class="header-anchor">#</a> Distributed Operation</h2> <p>Either make <code>NotifierKit()</code> or <code>makeSubscriberKit()</code> can be used in a multicast
manner with good distributed systems properties, where there is only one
producing site but any number of consuming sites. The producer is not vulnerable
to the consumers; they cannot cause the kit to malfunction or prevent the code
producing values from making progress. The consumers cannot cause each other  to
hang or miss values.</p> <p>For distributed operation, all the iteration values---non-final values,
successful completion value, failure reason---must be <code>Passable</code>; values that
can somehow be passed between vats. The rest of this doc assumes all these
values are Passable.</p> <p>The <code>makeNotifierKit()</code> or <code>makeSubscriptionKit()</code> call makes the notifier/updater
or publication/subscription pair on the producer's site. As a result, both the
<code>iterationObserver</code> and the initial <code>asyncIterable</code> are on the producer's site. If
Producer Paula sends Consumer Bob the <code>asyncIterable</code>, Bob receives a possibly
remote reference to it. Producers and their Consumers can be remote from each
other.</p> <p>Bob's example code above is still correct if he uses this reference directly, since
<code>observeIteration</code> only needs its first argument to be a reference of some sort to
an <code>AsyncIterable</code> conveying <code>Passable</code> values. This reference may be a local
<code>AsyncIterable</code>, a remote presence of an <code>AsyncIterable</code>, or a local or remote
promise for an <code>AsyncIterable</code>. <code>observeIteration</code> only sends it eventual messages
using <code>E()</code>  and so doesn't care about these differences.</p> <p>However, Bob’s code is sub-optimal. Its distributed systems properties are
not terrible, but Bob does better using <code>getSharableSubscriptionInternals()</code>
(provided by <code>SubscriptionKit</code>). This lets Bob make a local <code>AsyncIterable</code> that
coordinates better with producer Paula's <code>IterationObserver</code>.</p> <p>Subscriber Alice's above code is less forgiving. She's using JavaScript's
for-await-of loop which requires a local <code>AsyncIterable</code>. It cannot handle a
remote reference to an <code>AsyncIterable</code> at Paula's site. Alice has to make an
<code>AsyncIterable</code> at her site by using <code>getSharableSubsciptionInternals()</code>. She can
replace her call to <code>consume(subscription)</code> with:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> makeSubscription <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@agoric/notifier'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> localSubscription <span class="token operator">=</span>
  <span class="token function">makeSubscription</span><span class="token punctuation">(</span><span class="token constant">E</span><span class="token punctuation">(</span>subscription<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSharableSubsciptionInternals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">consume</span><span class="token punctuation">(</span>localSubscription<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The above used a SubscriptionKit. NotifierKits have a similar pair of a
<code>getSharableNotifierInternals()</code> method and a <code>makeNotifier</code>. However, this
technique requires Alice know what kind of possibly-remote <code>AsyncIterable</code>
she has, and to have the required making function code locally available.</p> <p>Alternatively, Alice can generically mirror any possibly remote <code>AsyncIterable</code> by
making a new local pair and plugging them together with <code>observeIteration</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>
  publication<span class="token operator">:</span> adapterPublication<span class="token punctuation">,</span>
  subscription<span class="token operator">:</span> adapterSubscription
<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">makeSubscriptionKit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">observeIteration</span><span class="token punctuation">(</span>subscription<span class="token punctuation">,</span> adapterPublication<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">consume</span><span class="token punctuation">(</span>adapterSubscription<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This works when subscription is a reference to any <code>AsyncIterable</code>. If Alice only
needs to consume in a lossy manner, she can use<code>makeNotifierKit()</code> instead, which
still works independently of what kind of <code>AsyncIterable</code> subscription is a
reference to.</p> <h2 id="summary"><a href="#summary" class="header-anchor">#</a> Summary</h2> <p>Data producers have to decide whether to publish losslessly or lossily. If
your consumers only care about more recent states, then use a <code>NotifierKit</code>.
This is often appropriate when the iteration represents a changing quantity.
If you want to support consumers that need to see all the values, then use a <code>SubscriptionKit</code>.</p> <p>Consumers can choose different ways of processing the data. In all cases,
the publisher doesn't have to know the consumers, and the consumers can't
interfere with the producer or each other.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Agoric/documentation/edit/main/main/guides/js-programming/notifiers.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/13/2021, 6:49:04 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/documentation/guides/js-programming/eventual-send.html" class="prev">
        Remote object communication with E()
      </a></span> <span class="next"><a href="/documentation/guides/js-programming/ses/ses-guide.html">
        SES Guide
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/documentation/assets/js/app.68c67527.js" defer></script><script src="/documentation/assets/js/2.055035d6.js" defer></script><script src="/documentation/assets/js/52.6c91e033.js" defer></script>
  </body>
</html>
