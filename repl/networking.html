<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Network API | Beta</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/documentation/favicon-full.ico">
    <style type="text/css">
    .two-col-table td {
        width: 50%;
    }
    .two-col-table table {
        table-layout: fixed;
    }</style>
    <script src="https://www.googletagmanager.com/gtag/js?id=UA-118217811-1"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-118217811-1'); </script>
    <script>
    const logoUrlChanger = setInterval(function() {
    //Anchor above the logo image
    const homeEls = document.getElementsByClassName("home-link");
    if(homeEls.length > 0) {
      const homeEl = homeEls[0];
      homeEl.setAttribute("href", "https://agoric.com");
      homeEl.setAttribute("onclick", "return false;");
      clearInterval(logoUrlChanger);
    }

    //Actual logo image
    const logoEls = document.getElementsByClassName("logo")
    if(logoEls.length > 0) {
      const logoEl = logoEls[0]
      logoEl.setAttribute("onclick", "document.location='https://agoric.com';return false;");
      clearInterval(logoUrlChanger);
    }
   }, 1000) </script>
    <meta name="description" content="Build, deploy and operate dApps and DeFi markets.">
    
    <link rel="preload" href="/documentation/assets/css/0.styles.3032228c.css" as="style"><link rel="preload" href="/documentation/assets/js/app.da687f13.js" as="script"><link rel="preload" href="/documentation/assets/js/2.055035d6.js" as="script"><link rel="preload" href="/documentation/assets/js/61.c0071f2f.js" as="script"><link rel="prefetch" href="/documentation/assets/js/10.605dc77e.js"><link rel="prefetch" href="/documentation/assets/js/11.5da275b9.js"><link rel="prefetch" href="/documentation/assets/js/12.e462e083.js"><link rel="prefetch" href="/documentation/assets/js/13.5d1f0876.js"><link rel="prefetch" href="/documentation/assets/js/14.fa0ecac6.js"><link rel="prefetch" href="/documentation/assets/js/15.76ec7550.js"><link rel="prefetch" href="/documentation/assets/js/16.4dde13c7.js"><link rel="prefetch" href="/documentation/assets/js/17.ac5057b1.js"><link rel="prefetch" href="/documentation/assets/js/18.e5d573f0.js"><link rel="prefetch" href="/documentation/assets/js/19.f6159705.js"><link rel="prefetch" href="/documentation/assets/js/20.ba9a8c81.js"><link rel="prefetch" href="/documentation/assets/js/21.2bf0bcc8.js"><link rel="prefetch" href="/documentation/assets/js/22.3c41c5fe.js"><link rel="prefetch" href="/documentation/assets/js/23.3ce7e6cd.js"><link rel="prefetch" href="/documentation/assets/js/24.8c188fe2.js"><link rel="prefetch" href="/documentation/assets/js/25.dfc3a7e2.js"><link rel="prefetch" href="/documentation/assets/js/26.e44ec958.js"><link rel="prefetch" href="/documentation/assets/js/27.eb56a11b.js"><link rel="prefetch" href="/documentation/assets/js/28.2c771e17.js"><link rel="prefetch" href="/documentation/assets/js/29.85d5b3f2.js"><link rel="prefetch" href="/documentation/assets/js/3.63afc3fb.js"><link rel="prefetch" href="/documentation/assets/js/30.11a3f04c.js"><link rel="prefetch" href="/documentation/assets/js/31.e0b02dd4.js"><link rel="prefetch" href="/documentation/assets/js/32.8be30b6e.js"><link rel="prefetch" href="/documentation/assets/js/33.e54a111c.js"><link rel="prefetch" href="/documentation/assets/js/34.abf68cfb.js"><link rel="prefetch" href="/documentation/assets/js/35.4905b9e8.js"><link rel="prefetch" href="/documentation/assets/js/36.77a11032.js"><link rel="prefetch" href="/documentation/assets/js/37.33c60f41.js"><link rel="prefetch" href="/documentation/assets/js/38.1d63897e.js"><link rel="prefetch" href="/documentation/assets/js/39.dd769763.js"><link rel="prefetch" href="/documentation/assets/js/4.8df52773.js"><link rel="prefetch" href="/documentation/assets/js/40.b9ed46db.js"><link rel="prefetch" href="/documentation/assets/js/41.195c2fed.js"><link rel="prefetch" href="/documentation/assets/js/42.715dd231.js"><link rel="prefetch" href="/documentation/assets/js/43.03689eb2.js"><link rel="prefetch" href="/documentation/assets/js/44.eb0ba454.js"><link rel="prefetch" href="/documentation/assets/js/45.e505a54c.js"><link rel="prefetch" href="/documentation/assets/js/46.e51f13d5.js"><link rel="prefetch" href="/documentation/assets/js/47.82d4529a.js"><link rel="prefetch" href="/documentation/assets/js/48.8077f294.js"><link rel="prefetch" href="/documentation/assets/js/49.ff94e9b9.js"><link rel="prefetch" href="/documentation/assets/js/5.a4c90d63.js"><link rel="prefetch" href="/documentation/assets/js/50.329a4a22.js"><link rel="prefetch" href="/documentation/assets/js/51.ffdf1ddb.js"><link rel="prefetch" href="/documentation/assets/js/52.6c91e033.js"><link rel="prefetch" href="/documentation/assets/js/53.d73e87c6.js"><link rel="prefetch" href="/documentation/assets/js/54.a0543c47.js"><link rel="prefetch" href="/documentation/assets/js/55.2d6c3f6b.js"><link rel="prefetch" href="/documentation/assets/js/56.8a687967.js"><link rel="prefetch" href="/documentation/assets/js/57.e8142a9a.js"><link rel="prefetch" href="/documentation/assets/js/58.4b1eb2c0.js"><link rel="prefetch" href="/documentation/assets/js/59.801d9e70.js"><link rel="prefetch" href="/documentation/assets/js/6.71d1ebbc.js"><link rel="prefetch" href="/documentation/assets/js/60.7871118c.js"><link rel="prefetch" href="/documentation/assets/js/62.44a5d526.js"><link rel="prefetch" href="/documentation/assets/js/63.140fafdc.js"><link rel="prefetch" href="/documentation/assets/js/64.e3e1337d.js"><link rel="prefetch" href="/documentation/assets/js/65.7fa0218b.js"><link rel="prefetch" href="/documentation/assets/js/66.832d7f9e.js"><link rel="prefetch" href="/documentation/assets/js/67.53f93283.js"><link rel="prefetch" href="/documentation/assets/js/68.c7a0635a.js"><link rel="prefetch" href="/documentation/assets/js/69.4000f7c9.js"><link rel="prefetch" href="/documentation/assets/js/7.4c1fadb9.js"><link rel="prefetch" href="/documentation/assets/js/70.f8fc51b7.js"><link rel="prefetch" href="/documentation/assets/js/71.b044f934.js"><link rel="prefetch" href="/documentation/assets/js/72.6140ad96.js"><link rel="prefetch" href="/documentation/assets/js/73.13329aae.js"><link rel="prefetch" href="/documentation/assets/js/74.de457219.js"><link rel="prefetch" href="/documentation/assets/js/75.54fe6f01.js"><link rel="prefetch" href="/documentation/assets/js/76.5659e85d.js"><link rel="prefetch" href="/documentation/assets/js/77.57a2e97b.js"><link rel="prefetch" href="/documentation/assets/js/78.d47996b6.js"><link rel="prefetch" href="/documentation/assets/js/79.3fced6e1.js"><link rel="prefetch" href="/documentation/assets/js/8.8d1474ce.js"><link rel="prefetch" href="/documentation/assets/js/80.2bfb7526.js"><link rel="prefetch" href="/documentation/assets/js/81.25589c5a.js"><link rel="prefetch" href="/documentation/assets/js/82.488825da.js"><link rel="prefetch" href="/documentation/assets/js/83.46a3b958.js"><link rel="prefetch" href="/documentation/assets/js/84.a807202d.js"><link rel="prefetch" href="/documentation/assets/js/85.e80307ee.js"><link rel="prefetch" href="/documentation/assets/js/86.7ebcc02d.js"><link rel="prefetch" href="/documentation/assets/js/87.9aecbc10.js"><link rel="prefetch" href="/documentation/assets/js/88.b7ef1a4e.js"><link rel="prefetch" href="/documentation/assets/js/89.a1df23c9.js"><link rel="prefetch" href="/documentation/assets/js/9.1992c59f.js"><link rel="prefetch" href="/documentation/assets/js/90.dc917323.js"><link rel="prefetch" href="/documentation/assets/js/91.c661fe84.js"><link rel="prefetch" href="/documentation/assets/js/92.56e89761.js"><link rel="prefetch" href="/documentation/assets/js/93.653e0d6f.js"><link rel="prefetch" href="/documentation/assets/js/94.a361a519.js"><link rel="prefetch" href="/documentation/assets/js/95.293f2fe4.js">
    <link rel="stylesheet" href="/documentation/assets/css/0.styles.3032228c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/documentation/" class="home-link router-link-active"><img src="/documentation/logo.svg" alt="Beta" class="logo"> <span class="site-name can-hide">Beta</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link router-link-active">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Getting Started Menu" class="dropdown-title"><span class="title">Getting Started</span> <span class="arrow down"></span></button> <button type="button" aria-label="Getting Started Menu" class="mobile-dropdown-title"><span class="title">Getting Started</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/before-using-agoric.html" class="nav-link">
  Before Using Agoric
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/start-a-project.html" class="nav-link">
  Starting a Project
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/development-cycle.html" class="nav-link">
  Development Cycle
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/deploying.html" class="nav-link">
  Deploying Smart Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction.html" class="nav-link">
  ERTP Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Zoe Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/getting-started/beta.html" class="nav-link">
  Agoric Beta
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guides" class="dropdown-title"><span class="title">Guides</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guides" class="mobile-dropdown-title"><span class="title">Guides</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/" class="nav-link">
  Documentation
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/agoric-cli/" class="nav-link">
  Agoric CLI Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/dapps/" class="nav-link">
  Agoric Dapps
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  ERTP
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Zoe
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/js-programming/" class="nav-link">
  Agoric JavaScript Programming
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/wallet/" class="nav-link">
  Wallet Guide and API
</a></li><li class="dropdown-item"><!----> <a href="/documentation/repl/" class="nav-link router-link-active">
  REPL
</a></li><li class="dropdown-item"><!----> <a href="/documentation/guides/chainlink-integration.html" class="nav-link">
  Chainlink Integration
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/blob/master/packages/SwingSet/docs/networking.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dynamic IBC (dIBC)
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Zoe Menu" class="dropdown-title"><span class="title">Zoe</span> <span class="arrow down"></span></button> <button type="button" aria-label="Zoe Menu" class="mobile-dropdown-title"><span class="title">Zoe</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/intro-zoe.html" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/guide/contracts/" class="nav-link">
  Contracts
</a></li><li class="dropdown-item"><!----> <a href="/documentation/zoe/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/zoe" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ERTP Menu" class="dropdown-title"><span class="title">ERTP</span> <span class="arrow down"></span></button> <button type="button" aria-label="ERTP Menu" class="mobile-dropdown-title"><span class="title">ERTP</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/getting-started/ertp-introduction/" class="nav-link">
  Introduction
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/documentation/ertp/api/" class="nav-link">
  API
</a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/agoric-sdk/tree/master/packages/ERTP" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Platform Menu" class="dropdown-title"><span class="title">Platform</span> <span class="arrow down"></span></button> <button type="button" aria-label="Platform Menu" class="mobile-dropdown-title"><span class="title">Platform</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/documentation/platform/" class="nav-link">
  Agoric Stack
</a></li></ul></div></div><div class="nav-item"><a href="/documentation/glossary/" class="nav-link">
  Glossary
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Learn More Menu" class="dropdown-title"><span class="title">Learn More</span> <span class="arrow down"></span></button> <button type="button" aria-label="Learn More Menu" class="mobile-dropdown-title"><span class="title">Learn More</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://agoric.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Agoric
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://agoric.com/papers/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Papers
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://www.youtube.com/channel/UCpY91oQLh_Lp0mitdZ5bYWg/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  YouTube
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://github.com/Agoric/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Network API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/documentation/repl/networking.html#the-agoric-sdk-user-local-port" class="sidebar-link">The agoric-sdk User Local Port</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#connecting-to-a-remote-port" class="sidebar-link">Connecting to a Remote Port</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#opening-a-listening-port-and-accepting-an-inbound-connection" class="sidebar-link">Opening a Listening Port and Accepting an Inbound Connection</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#sending-data" class="sidebar-link">Sending Data</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#receiving-data-the-connectionhandler" class="sidebar-link">Receiving Data: The ConnectionHandler</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#closing-the-connection" class="sidebar-link">Closing the Connection</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/documentation/repl/networking.html#removing-a-listener" class="sidebar-link">Removing a Listener</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/documentation/repl/networking.html#closing-the-port-entirely" class="sidebar-link">Closing the Port Entirely</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="network-api"><a href="#network-api" class="header-anchor">#</a> Network API</h1> <p>Suitably-empowered code inside a vat can access a &quot;network API&quot; that works
vaguely like the BSD socket API. This code can:</p> <ul><li>Open a listening port on various networking stacks.</li> <li>Initiate connections to remote ports.</li> <li>Send and receive data over these connections</li> <li>Finally close the connection and/or ports.</li></ul> <p>The type of connection is limited by the host in which the vat is running.
Chain-based machines must operate in a platonic realm of replicated consensus,
so their network options are limited to protocols like IBC, which allow one
gestalt chain to talk to other chain-like entities. Each such entity is
defined by an evolving set of consensus rules, which typically include a
current set of validator public keys and a particular history of hashed
block identifiers.</p> <p>[<strong>CAVEAT:</strong> IBC uses &quot;Connection&quot; to mean a chain-to-chain &quot;hop&quot;, and
&quot;Channel&quot; to mean a Port-to-Port pathway through a series of hops.
https://github.com/cosmos/ics/blob/master/ibc/1_IBC_TERMINOLOGY.md#connection .
This is unfortunate, because IBC &quot;Channels&quot; correspond most precisely to
TCP &quot;connections&quot;, and most discussions of network APIs (including this one,
below) will talk about &quot;connections&quot; extensively.</p> <p>For now, our IBC implementation can only use pre-established hops, and provides
no means for user-level code to create new hops (IBC Connections) at runtime.
But user-level code can create new IBC Channels at any time. The terminology
confusion will be most obvious in the section on &quot;Accepting an Inbound Connection&quot;,
where the user code is really accepting an inbound <em>IBC Channel</em>.]</p> <p>A channel via these IBC hops will terminate in IBC-aware code on either end.
These endpoints might be traditional (static) IBC handlers (such as an ICS-20
token transfer module), or dynamic IBC handlers (e.g. running in a SwingSet vat).
SwingSet vat code that wants to speak to vat code in a different SwingSet machine
would not use the IBC connection directly: instead it would simply perform normal
eventual-send operations (<code>target~.foo(args)</code>) and let the &quot;CapTP&quot; promise-pipelining
layer handle the details. But vat code which wants to speak to an ICS-20 handler
in some other chain would need to use this layer.</p> <p>Vats which live inside a solo machine are able to use traditional networking layers,
like TCP, HTTP, and WebSockets. This enables them to communicate with e.g.
browser-side UI frontends that use WebSockets to query the vat for order status.
These connections do not have to follow normal ocap rules, so vat code which accept
them must provide their own authentication and access control protections.</p> <p>Solo machines may be able to talk to chains and vice versa using specialized
protocols. This will be used by CapTP to provide ocap messaging between these
heterogeneous machine types.</p> <h2 id="the-agoric-sdk-user-local-port"><a href="#the-agoric-sdk-user-local-port" class="header-anchor">#</a> The agoric-sdk User Local Port</h2> <p>Each user of the Agoric testnet gets a few personal IBC listening ports. You
can access these <code>Port</code> objects in the <code>home.ibcport</code> array, and you can learn
their local address by calling something like <code>home.ibcport[0]~.getLocalAddress()</code>,
which will give you a local address like <code>/ibc-port/portbvmnfb</code>.</p> <p>This is currently the only way for user code to get an IBC <code>Port</code>, though non-IBC
ports can be allocated using the local <code>home.network</code> object.  This is an advanced
use case, to be documented later.</p> <h2 id="connecting-to-a-remote-port"><a href="#connecting-to-a-remote-port" class="header-anchor">#</a> Connecting to a Remote Port</h2> <p>To establish a connection, you must start with a local <code>Port</code> object, and you must
know the name of the remote endpoint. The remote endpoint will have a name like
<code>/ibc-hop/$HOPNAME/ibc-port/$PORTNAME/ordered/$VERSION</code> (where <code>ibc-hop</code>, <code>ibc-port</code>
and <code>ordered</code> are literal strings, spelled just like that, but <code>$HOPNAME</code>, <code>$PORTNAME</code>,
and <code>$VERSION</code> are placeholders for arbitrary values that will vary from one endpoint
to another).</p> <p>You must also prepare a <code>ConnectionHandler</code> object to manage the connection you're
about to create. This has a number of methods which will be called when the things
happen to the connection, including packets arriving. This is described below.</p> <p>Then you will call the <code>connect()</code> method on your local <code>Port</code>. This will return
a <code>Promise</code> that will fire with a new <code>Connection</code> object, on which you can send
data. Your <code>ConnectionHandler</code> will be notified about the new channel, and will
receive inbound data from the other side.</p> <div class="language-js extra-class"><pre class="language-js"><code>home<span class="token punctuation">.</span>ibcport<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">~</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> connectionHandler<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">conn</span> <span class="token operator">=&gt;</span> <span class="token function">doSomethingWithConnection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="opening-a-listening-port-and-accepting-an-inbound-connection"><a href="#opening-a-listening-port-and-accepting-an-inbound-connection" class="header-anchor">#</a> Opening a Listening Port and Accepting an Inbound Connection</h2> <p>The other side of <code>connect()</code> is a &quot;listening port&quot;. These ports are waiting for
inbound connections to be established.</p> <p>To get a listening port, you need a <code>NetworkInterface</code> object (such as the one on
your <code>ag-solo</code> under <code>home.network</code>) and ask it to <code>bind()</code> to an endpoint. You
can either provide a specific port name, or allow the API to allocate a random
one for you. The endpoint specifies the type of connection that this port will
be able to accept (IBC, TCP, etc), and some properties of that connection. <code>bind()</code>
uses a &quot;multiaddress&quot; to encode this information.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ask for a random allocation - ends with a slash</span>
home<span class="token punctuation">.</span>network<span class="token operator">~</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>'<span class="token operator">/</span>ibc<span class="token operator">-</span>port<span class="token operator">/</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">)
  .then(port =&gt; usePort(port));
//
// or ask for a specific port name
home.network~.bind('/ibc-port/my-cool-port-name</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">port</span> <span class="token operator">=&gt;</span> <span class="token function">usePort</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>IBC has named &quot;hops&quot; (what they call &quot;Connections&quot; in the IBC spec) which each
carry data between two specific chains.  These hops are different from the
connections described in this document.  When you bind a port like <code>/ibc-port/$PORT</code>
without specifying the &quot;hop&quot;, any IBC chain can initiate a connection to this port.</p> <p>You can ask the <code>Port</code> object this returns for its local address, which is especially
useful if you had asked for a random allocation (since otherwise you have no way
to know what address you got):</p> <div class="language-js extra-class"><pre class="language-js"><code>port<span class="token operator">~</span><span class="token punctuation">.</span><span class="token function">getLocalAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">localAddress</span> <span class="token operator">=&gt;</span> <span class="token function">useIt</span><span class="token punctuation">(</span>localAddress<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><code>home.ibcport[0]~.addListener()</code></p> <p>Once the port is bound, you must call <code>addListener</code> to mark it as ready for inbound
connections. You must provide this with a <code>ListenHandler</code> object, which has methods
to react to listening events. As with <code>ConnectionHandler</code>, these methods are all
optional.</p> <ul><li><code>onListen(port, handler)</code>: called when the port starts listening</li> <li><code>onAccept(port, remote, handler)</code>: called when a new channel has been accepted</li> <li><code>onError(port, rejection, handler)</code>: called if the port is no longer able to accept channels, such as if the Connection to the remote chain has failed, perhaps because a consensus failure was observed</li> <li><code>onRemove(port, handler)</code>: called when the <code>ListenHandler</code> is being removed</li></ul> <p>Once your <code>ChannelHandler</code> is prepared, call <code>addListener</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>port<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'listener is active'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>Of all the methods, <code>onAccept</code> is the interesting one. It is called with a <code>remote</code>
endpoint, which tells you the address of the <code>Port</code> at the other end, where someone
else called <code>.connect</code>. You can use this to decide if you want to accept the
connection, or what sort of authority to exercise in response to messages arriving
therein.</p> <p>If you choose to accept, your <code>onAccept</code> method must return a <code>Promise</code> that fires
with a <code>ConnectionHandler</code>. This will be used just like the one you would pass into
<code>connect()</code>. To decline, throw an error.</p> <h2 id="sending-data"><a href="#sending-data" class="header-anchor">#</a> Sending Data</h2> <p>The Networking API (at least for IBC) provides a &quot;record pipe&quot;, in which each packet
is transmitted intact over the network, requiring no additional framing to distinguish
where one packet ends and the next one begins. This is in contrast to the &quot;byte pipe&quot;
provided by a TCP connection, where you must typically prepend length headers to
establish framing boundaries.</p> <p>Once you have a <code>Connection</code> object, you send data by calling its <code>send</code> method:</p> <div class="language-js extra-class"><pre class="language-js"><code>connection<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>send</code> actually returns a Promise (for more <code>Bytes</code>), which contains the ACK data
for this message.  For IBC, if anything but an empty <code>''</code> ACK is needed, you must
resolve the <code>onReceive</code> returned Promise within the same block as the received
packet message (i.e. it must not depend upon further input from the chain in order
to resolve).  This restriction may be enforced differently or lifted for other
network implementations.</p> <p>NOTE: The type of this data is currently a string.  Ideally we would also accept
Node.js <code>Buffer</code> objects, or Javascript <code>ArrayBuffer</code> and <code>TypedArray</code> objects,
but unfortunately neither can be serialized by our current inter-vat marshalling code.</p> <h2 id="receiving-data-the-connectionhandler"><a href="#receiving-data-the-connectionhandler" class="header-anchor">#</a> Receiving Data: The ConnectionHandler</h2> <p>You must provide each open connection with a <code>ConnectionHandler</code> object, where
you write methods that will be called when various things happen to the connection.
You can share a single handler object between multiple connections, if you like,
or you can make a separate one for each.</p> <p>You can omit any of the methods and those events will simply be ignored. All these
methods include the Connection object as the first argument, and the <code>ConnectionHandler</code>
itself as the last argument, which might help if you want to share a common handler
function among multiple connections.</p> <ul><li><code>onOpen(connection, handler)</code>: this is called when the connection is established,
which tells you that the remote end has successfully accepted the connection request</li> <li><code>onReceive(connection, packetBytes, handler)</code>: this is called each time the
remote end sends a packet full of data</li> <li><code>onClose(connection, reason, handler)</code>: this is called when the connection is closed,
either because one side wanted it to close, or because an error occurred</li></ul> <p>The <code>reason</code> in <code>onclose</code> is optional, as in it may be <code>undefined</code>.</p> <p><code>onReceive</code> is the most important method. Each time the remote end sends a packet,
your <code>onReceive</code> method will be called with the data inside that packet (currently
as a String, but ideally as an ArrayBuffer with a custom <code>.toString()</code> method with
an optional <code>encoding</code> argument (default <code>'latin1'</code>), so that it can contain
arbitrary bytes).</p> <p>The return value of <code>onReceive</code> is nominally a Promise for the ACK data of the
message (and should thus appear as the eventual resolution of the Promise returned
by <code>connection.send()</code> on the other side). However the ACK data can only appear in
the block which includes the transaction that delivered the message, so there is a
limited time window during which this data can be successfully delivered, and there
is no guarantee that <code>onReceive</code> will return a Promise that resolves in time.  If
the promise does not resolve in time, the implementation will automatically send
an empty <code>''</code> ACK.  Because ACKs with data in them are difficult for your handler
to get right, it is better to avoid them, where possible.</p> <h2 id="closing-the-connection"><a href="#closing-the-connection" class="header-anchor">#</a> Closing the Connection</h2> <p>When a given Connection ceases to be useful, you should close it:</p> <div class="language-js extra-class"><pre class="language-js"><code>connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This initiates a shutdown. The <code>ConnectionHandler</code> on both sides will eventually
see their <code>onClose()</code> methods be called, with a <code>reason</code>.  It allows them to
distinguish an intentional <code>onClose()</code> (<code>reason</code> is <code>undefined</code>) from some error
condition.</p> <h2 id="removing-a-listener"><a href="#removing-a-listener" class="header-anchor">#</a> Removing a Listener</h2> <p>When you no longer wish to receive connections on a port, you can remove the listener:</p> <div class="language-js extra-class"><pre class="language-js"><code>port<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'removed'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>You must provide the handler you added, to enable the future ability to have
multiple listeners on the same port.</p> <p>Note that if you want to listen on this port again, you can just
call <code>port.addListener(...)</code>, as before.  If you want to start a new connection,
you can always call <code>port.connect(...)</code>.</p> <h3 id="closing-the-port-entirely"><a href="#closing-the-port-entirely" class="header-anchor">#</a> Closing the Port Entirely</h3> <p>Removing a listener doesn't release the port address to make it available
for other <code>bind</code> requests.  You can call:</p> <div class="language-js extra-class"><pre class="language-js"><code>port<span class="token punctuation">.</span><span class="token function">revoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>to completely deallocate the port, remove all listeners, close all pending
connections, and release its address.</p> <p><strong>CAUTION:</strong> Be aware that if you call <code>home.ibcport[0]~.revoke()</code>, it will be
useless for new <code>.connect</code> or <code>.addListener</code> attempts.  You will need to provision
a new Agoric client via https://testnet.agoric.com/ to obtain a new setup with a
functioning <code>home.ibcport</code>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Agoric/documentation/edit/main/main/repl/networking.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/25/2021, 7:45:51 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/documentation/assets/js/app.da687f13.js" defer></script><script src="/documentation/assets/js/2.055035d6.js" defer></script><script src="/documentation/assets/js/61.c0071f2f.js" defer></script>
  </body>
</html>
