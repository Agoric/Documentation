(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{452:function(e,t,a){"use strict";a.r(t);var s=a(44),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"far-and-remotable-objects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#far-and-remotable-objects"}},[e._v("#")]),e._v(" "),a("code",[e._v("Far()")]),e._v(" and Remotable Objects")]),e._v(" "),a("h2",{attrs:{id:"remotable-and-passable-objects"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#remotable-and-passable-objects"}},[e._v("#")]),e._v(" Remotable and passable objects")]),e._v(" "),a("p",[e._v("In Agoric smart contracts and dapps, you can call methods on objects from other vats or machines.\nFor example, a purse for an ERTP issuer actually lives in the issuer's vat. But code in your off-chain\nwallet or another contract can still use that purse.")]),e._v(" "),a("p",[e._v("This is possible because Agoric encapsulates inter-machine and inter-vat communication. At\nthe smart contract or dapp level, objects from other vats or machines can almost be treated\nas if they are local.")]),e._v(" "),a("p",[e._v("To call a method on an object from another vat or machine, you must\nuse "),a("RouterLink",{attrs:{to:"/guides/js-programming/eventual-send.html#remote-object-communication-with-e"}},[a("code",[e._v("E()")])]),e._v(". For example, getting\nan "),a("code",[e._v("Issuer")]),e._v("'s "),a("code",[e._v("brand")]),e._v(" would look like "),a("code",[e._v("E(issuer).getBrand()")]),e._v(".")],1),e._v(" "),a("p",[e._v("Objects intended to be used from other vats are called "),a("em",[e._v("remotables")]),e._v(". Remote messages sent to\nremotables must only contain "),a("em",[e._v("passable")]),e._v(" arguments and return "),a("em",[e._v("passable")]),e._v(" results.\nPassables includes all things that can be passed as arguments in messages.")]),e._v(" "),a("p",[e._v("There are three kinds of passables:")]),e._v(" "),a("ul",[a("li",[e._v("Remotables, objects with methods that can be called remotely using "),a("code",[e._v("E()")]),e._v(".")]),e._v(" "),a("li",[e._v("Pass-by-copy data, such as numbers or hardened records")]),e._v(" "),a("li",[e._v("Promises for passables.")])]),e._v(" "),a("p",[e._v("In particular, note that every object returned from a smart contract, such a "),a("code",[e._v("publicFacet")]),e._v(" or\n"),a("code",[e._v("creatorFacet")]),e._v(", must be passable. All objects used in your contract's external API must\nbe passable.")]),e._v(" "),a("h3",{attrs:{id:"rules-for-creating-remotables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#rules-for-creating-remotables"}},[e._v("#")]),e._v(" Rules for creating remotables")]),e._v(" "),a("ul",[a("li",[e._v("All property values must be functions.\n"),a("ul",[a("li",[e._v("They cannot be accessors.")])])]),e._v(" "),a("li",[e._v("You must wrap the object with "),a("code",[e._v("Far()")]),e._v(".")])]),e._v(" "),a("p",[a("strong",[e._v("Note")]),e._v(": ERTP objects, such as "),a("code",[e._v("Purses")]),e._v(", are automatically created as "),a("code",[e._v("Remotable")]),e._v(", as are\n"),a("code",[e._v("UserSeats")]),e._v(" and "),a("code",[e._v("ZCFSeats")]),e._v(".")]),e._v(" "),a("h3",{attrs:{id:"using-remotables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-remotables"}},[e._v("#")]),e._v(" Using remotables")]),e._v(" "),a("ul",[a("li",[e._v("Call a remotable's method by first wrapping the remotable object with "),a("code",[e._v("E")]),e._v(", such as "),a("code",[e._v("E(issuer).getBrand();")])]),e._v(" "),a("li",[e._v("Handle the resulting promise. Calling "),a("code",[e._v("E()")]),e._v(" always results in a "),a("code",[e._v("Promise")]),e._v(".")])]),e._v(" "),a("h2",{attrs:{id:"using-far"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-far"}},[e._v("#")]),e._v(" Using "),a("code",[e._v("Far()")])]),e._v(" "),a("p",[a("code",[e._v("Far(farName, object-with-methods)")])]),e._v(" "),a("ul",[a("li",[a("code",[e._v("farName")]),e._v(" "),a("code",[e._v("{ String }")])]),e._v(" "),a("li",[a("code",[e._v("object-with-methods")]),e._v(" "),a("code",[e._v("{ Object }")]),e._v(" "),a("code",[e._v("[remotable={}]")])]),e._v(" "),a("li",[e._v("Returns: A "),a("code",[e._v("Remotable")]),e._v(" object.")])]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("farName")]),e._v(" parameter gives the "),a("code",[e._v("Remotable")]),e._v(" an "),a("em",[e._v("interface name")]),e._v(" for debugging purposes, which only shows\nup when logged through the "),a("code",[e._v("console")]),e._v(", for example with "),a("code",[e._v("console.log")]),e._v(".")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("object-with-methods")]),e._v(" parameter should be an object whose properties are the functions serving\nas the object's methods. See the example code below.")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("Far()")]),e._v(" function marks an object as remotable.  "),a("code",[e._v("Far()")]),e._v(" also:")]),e._v(" "),a("ul",[a("li",[e._v("Hardens the object.\n"),a("ul",[a("li",[e._v("Both "),a("code",[e._v("harden()")]),e._v(" and "),a("code",[e._v("Far()")]),e._v(" function harden the object.")]),e._v(" "),a("li",[e._v("Only hardened objects are passable.")])])]),e._v(" "),a("li",[e._v("Checks for the property and value requirements above.\nIf they are not met, it throws an error.")]),e._v(" "),a("li",[e._v("Records the object's interface name.")])]),e._v(" "),a("p",[e._v("You should call "),a("code",[e._v("Far()")]),e._v(" on an object if it both:")]),e._v(" "),a("ul",[a("li",[e._v("Will be sent out of its native vat.\n"),a("ul",[a("li",[e._v("If it might ever appear as the "),a("code",[e._v("foo")]),e._v(" in "),a("RouterLink",{attrs:{to:"/guides/js-programming/eventual-send.html"}},[a("code",[e._v("E(foo).method(args)")])]),e._v(","),a("br"),e._v("\nyou should run "),a("code",[e._v("Far()")]),e._v(" on it after creating it.")],1)])]),e._v(" "),a("li",[e._v("Has methods called on it, as opposed to just effectively storing data.")])]),e._v(" "),a("p",[e._v("Only passables can be passed as arguments or returned as results,\nand they must be hardened. If the passable is a remotable, it must be hardened with "),a("code",[e._v("Far()")]),e._v(".\nOtherwise, it must be hardened with "),a("RouterLink",{attrs:{to:"/guides/js-programming/ses/ses-guide.html#harden"}},[a("code",[e._v("harden()")])]),e._v(".")],1),e._v(" "),a("p",[e._v("An error\nis thrown if you call "),a("code",[e._v("Far()")]),e._v(" on a record, instead of an object, which doesn't have function\nvalues. However, if object "),a("code",[e._v("foo")]),e._v(" should never be exposed to other vats, you should make it\na point "),a("strong",[e._v("not")]),e._v(" to use "),a("code",[e._v("Far()")]),e._v(" on it. If "),a("code",[e._v("foo")]),e._v(" is not marked as a remotable but is accidentally\nexposed, an error is thrown. This prevents any vulnerability from such accidental exposure.")]),e._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("import")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" Far "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("from")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'@agoric/marshal'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("let")]),e._v(" counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("const")]),e._v(" countRemotable "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("Far")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("'counter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("increment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("decrement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" counter"),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("--")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("read")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("return")]),e._v(" counter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);