(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{403:function(t,e,a){"use strict";a.r(e);var s=a(42),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"zoe-contract-facet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zoe-contract-facet"}},[t._v("#")]),t._v(" Zoe Contract Facet")]),t._v(" "),a("Zoe-Version"),t._v(" "),a("p",[t._v("A Zoe Contract Facet is an API object for a running contract instance to access the Zoe state\nfor that instance. A Zoe Contract Facet is accessed synchronously from within the contract,\nand usually is referred to in code as "),a("code",[t._v("zcf")]),t._v(".")]),t._v(" "),a("p",[t._v("The contract instance is launched by "),a("code",[t._v("E(zoe).startInstance")]),t._v(", and is given access to\nthe "),a("code",[t._v("zcf")]),t._v(" object during that launch. In the operations below, "),a("code",[t._v("instance")]),t._v(" is\nthe handle for the running contract instance.")]),t._v(" "),a("h2",{attrs:{id:"start"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#start"}},[t._v("#")]),t._v(" start")]),t._v(" "),a("p",[t._v("This section covers the code you need to have at the start of your contract code.")]),t._v(" "),a("p",[t._v("To warn if the correct return values for your contract are not being returned,\nadd this right before the start of your contract code. It also lets TypeScript-aware\ntools (IDEs like vsCode and WebStorm) inform the developer about required parameters\nand return values and warn when methods are misused.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * @type {ContractStartFn}\n */")]),t._v("\n")])])]),a("p",[t._v("Your contract code must export a function "),a("code",[t._v("start")]),t._v(" as a non-default export.\n"),a("code",[t._v("zcf")]),t._v(" is the Zoe Contract Facet and is the only argument provided to the contract")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("start")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("zcf")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// your code here")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("harden")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" creatorFacet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" creatorInvitation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" publicFacet "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("harden")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("start"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" start "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("The contract must return a record with any (or none) of the following:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("creatorFacet")]),t._v(" - an object, usually with admin authority. It is only given to the entity that\ncalls "),a("code",[t._v("E(zoe).startInstance(...)")]),t._v("; i.e. the party that was the creator of the current contract instance.\nIt creates invitations for other parties, and takes actions that are unrelated to making offers.")]),t._v(" "),a("li",[a("code",[t._v("creatorInvitation")]),t._v(" - a Zoe invitation only given to the entity that calls "),a("code",[t._v("E(zoe).startInstance(...)")]),t._v("; i.e.\nthe party that was the creator of the current contract instance.\nThis is usually used when a party has to make an offer first, such as escrowing the underlying good\nfor sale in an auction or covered call.")]),t._v(" "),a("li",[a("code",[t._v("publicFacet")]),t._v(" - an object available through Zoe to anyone who knows the contract "),a("code",[t._v("instance")]),t._v(". Use the "),a("code",[t._v("publicFacet")]),t._v(" for general queries and actions, such as getting the current price or creating public invitations.")])]),t._v(" "),a("h2",{attrs:{id:"zcf-makezcfmint-keyword-amountmathkind"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-makezcfmint-keyword-amountmathkind"}},[t._v("#")]),t._v(" zcf.makeZCFMint(keyword, amountMathKind)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("keyword")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("code",[t._v("amountMathKind")]),t._v(" "),a("code",[t._v("{AmountMathKind}")]),t._v(" (defaults to "),a("code",[t._v("MathKind.NAT")]),t._v(")")]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{Promise<ZCFMint>}")])])]),t._v(" "),a("p",[t._v("Creates a synchronous Zoe mint, allowing users to mint and reallocate digital assets synchronously\ninstead of relying on an asynchronous ERTP "),a("code",[t._v("mint")]),t._v(".")]),t._v(" "),a("p",[a("strong",[t._v("Important")]),t._v(": "),a("code",[t._v("ZCFMints")]),t._v(" do "),a("strong",[t._v("not")]),t._v(" have the same methods as an ERTP "),a("code",[t._v("mint")]),t._v(". Do not try to use\nERTP methods on a "),a("code",[t._v("ZCFMint")]),t._v(" or vice versa.")]),t._v(" "),a("p",[a("strong",[t._v("Important")]),t._v(": On the other hand, the "),a("code",[t._v("issuer")]),t._v(", "),a("code",[t._v("brand")]),t._v(", and "),a("code",[t._v("amountMath")]),t._v(" associated with a "),a("code",[t._v("zcfMint")]),t._v("\ndo have the same methods as their ERTP-derived counterparts. Assets created by a "),a("code",[t._v("zcfMint")]),t._v(" are treated\nthe same as ERTP "),a("code",[t._v("mint")]),t._v("-created assets by ERTP methods.")]),t._v(" "),a("p",[a("code",[t._v("ZCFMints")]),t._v(" have three methods:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("getIssuerRecord()")]),t._v(" "),a("ul",[a("li",[t._v("Returns: "),a("code",[t._v("{IssuerRecord}")])]),t._v(" "),a("li",[t._v("Returns an "),a("code",[t._v("issuerRecord")]),t._v(" containing the "),a("code",[t._v("issuer")]),t._v(", "),a("code",[t._v("brand")]),t._v(", or "),a("code",[t._v("amountMath")]),t._v(" associated with the "),a("code",[t._v("zcfMint")]),t._v(".")])])]),t._v(" "),a("li",[a("code",[t._v("mintGains")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("gains")]),t._v(": "),a("code",[t._v("AmountKeywordRecord")])]),t._v(" "),a("li",[a("code",[t._v("zcfSeat")]),t._v(" "),a("code",[t._v("{ZCFSeat}")]),t._v(" - optional")]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{ZCFSeat}")])]),t._v(" "),a("li",[t._v("All "),a("code",[t._v("amounts")]),t._v(" in "),a("code",[t._v("gains")]),t._v(" must be of this "),a("code",[t._v("ZCFMint")]),t._v("'s "),a("code",[t._v("brand")]),t._v(".\nThe "),a("code",[t._v("gains")]),t._v("' keywords are in that seat's namespace.\nAdd the "),a("code",[t._v("gains")]),t._v(" to that seat's "),a("code",[t._v("allocation")]),t._v(", then\nmint that "),a("code",[t._v("amount")]),t._v(" of assets and assign it to the contract.\nIf a "),a("code",[t._v("seat")]),t._v(" is provided, it is returned. Otherwise a new "),a("code",[t._v("seat")]),t._v(" is\nreturned.")]),t._v(" "),a("li",[a("code",[t._v("zcfMint.mintGains({ Token: amount }, seat);")])])])]),t._v(" "),a("li",[a("code",[t._v("burnlosses")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("losses")]),t._v(": "),a("code",[t._v("AmountKeyWordRecord")])]),t._v(" "),a("li",[a("code",[t._v("zcfSeat")]),t._v(" : "),a("code",[t._v("{ZCFSeat}")])]),t._v(" "),a("li",[t._v("Returns: void")]),t._v(" "),a("li",[t._v("All "),a("code",[t._v("amounts")]),t._v(" in "),a("code",[t._v("losses")]),t._v(" must be of this "),a("code",[t._v("ZCFMint")]),t._v("'s "),a("code",[t._v("brand")]),t._v(".\nThe "),a("code",[t._v("losses")]),t._v("' keywords are in that "),a("code",[t._v("seat")]),t._v("'s namespace.\nSubtract "),a("code",[t._v("losses")]),t._v(" from that "),a("code",[t._v("seat")]),t._v("'s "),a("code",[t._v("allocation")]),t._v(", then\nburn that "),a("code",[t._v("amount")]),t._v(" of assets from the pooled "),a("code",[t._v("purse")]),t._v(".")]),t._v(" "),a("li",[a("code",[t._v("zcfMint.burnLosses({ Token: amount }, seat);")])])])])]),t._v(" "),a("p",[a("strong",[t._v("Note")]),t._v(": The call to make the "),a("code",[t._v("ZCFMint")]),t._v(" is asynchronous, but\ncalls to the resulting "),a("code",[t._v("ZCFMint")]),t._v(" are synchronous.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mySynchronousMint "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeZCFMint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MySyncMint'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'set'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" amountMath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" brand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" issuer "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" mySynchronousMint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getIssuerRecord")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmySynchronousMint"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mintGains")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" MyKeyword"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" amount "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" seat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-getinvitationissuer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getinvitationissuer"}},[t._v("#")]),t._v(" zcf.getInvitationIssuer()")]),t._v(" "),a("ul",[a("li",[t._v("Returns: "),a("router-link",{attrs:{to:"/ertp/api/issuer.html"}},[a("code",[t._v("{Issuer}")])])],1)]),t._v(" "),a("p",[t._v("Zoe has a single "),a("code",[t._v("invitationIssuer")]),t._v(" for the entirety of its\nlifetime. This method returns the Zoe "),a("code",[t._v("InvitationIssuer")]),t._v(", which\nvalidates user-received "),a("code",[t._v("invitations")]),t._v(" to participate\nin contract instances.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" invitationIssuer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInvitationIssuer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-saveissuer-issuer-keyword"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-saveissuer-issuer-keyword"}},[t._v("#")]),t._v(" zcf.saveIssuer(issuer, keyword)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("issuer")]),t._v(" "),a("code",[t._v("{Issuer}")])]),t._v(" "),a("li",[a("code",[t._v("keyword")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{Promise<IssuerRecord>}")])])]),t._v(" "),a("p",[t._v("Informs Zoe about an "),a("code",[t._v("issuer")]),t._v(" and returns a "),a("code",[t._v("promise")]),t._v(" for acknowledging\nwhen the "),a("code",[t._v("issuer")]),t._v(" is added and ready. The "),a("code",[t._v("keyword")]),t._v(" is the one associated\nwith the new "),a("code",[t._v("issuer")]),t._v(". It returns a promise for "),a("code",[t._v("issuerRecord")]),t._v(" of the new "),a("code",[t._v("issuer")])]),t._v(" "),a("p",[t._v("This saves an "),a("code",[t._v("issuer")]),t._v(" to Zoe.\nIt also has saved the "),a("code",[t._v("issuer")]),t._v(" information such that Zoe can handle offers involving\nthis "),a("code",[t._v("issuer")]),t._v(" and ZCF can provide the "),a("code",[t._v("issuerRecord")]),t._v(" ("),a("code",[t._v("amountMath")]),t._v(", "),a("code",[t._v("brand")]),t._v(", "),a("code",[t._v("issuer")]),t._v(")\nsynchronously on request.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("saveIssuer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("secondaryIssuer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" keyword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-makeinvitation-offerhandler-description-customproperties"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-makeinvitation-offerhandler-description-customproperties"}},[t._v("#")]),t._v(" zcf.makeInvitation(offerHandler, description, customProperties)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("offerHandler")]),t._v(" "),a("code",[t._v("{OfferHandle => Object}")])]),t._v(" "),a("li",[a("code",[t._v("description")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[a("code",[t._v("customProperties")]),t._v(" "),a("code",[t._v("{Object}")])]),t._v(" "),a("li",[t._v("Returns: "),a("router-link",{attrs:{to:"/ertp/api/payment.html#payment"}},[a("code",[t._v("{Promise<Invitation>}")])])],1)]),t._v(" "),a("p",[t._v("Make a credible Zoe "),a("code",[t._v("invitation")]),t._v(" for a smart contract. Note that "),a("code",[t._v("invitations")]),t._v(" are a special case\nof an ERTP "),a("code",[t._v("payment")]),t._v(". They are in a one-to-one relationship with the "),a("code",[t._v("invitationIssuer")]),t._v(", which is used\nto validate invitations and their "),a("code",[t._v("amounts")]),t._v(".")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("invitation")]),t._v("'s\n"),a("code",[t._v("value")]),t._v(" specifies:")]),t._v(" "),a("ul",[a("li",[t._v("The specific contract "),a("code",[t._v("instance")]),t._v(".")]),t._v(" "),a("li",[t._v("The Zoe "),a("code",[t._v("installation")]),t._v(".")]),t._v(" "),a("li",[t._v("A unique "),a("code",[t._v("handle")])])]),t._v(" "),a("p",[t._v("The second argument is a required "),a("code",[t._v("description")]),t._v(" for the "),a("code",[t._v("invitation")]),t._v(",\nand should include whatever information is needed for a potential recipient of the "),a("code",[t._v("invitation")]),t._v("\nto know what they are getting in the optional "),a("code",[t._v("customProperties")]),t._v(" argument, which is\nput in the "),a("code",[t._v("invitation")]),t._v("'s "),a("code",[t._v("value")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" creatorInvitation "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeInvitation")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("makeCallOption"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'makeCallOption'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-makeemptyseatkit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-makeemptyseatkit"}},[t._v("#")]),t._v(" zcf.makeEmptySeatKit()")]),t._v(" "),a("ul",[a("li",[t._v("Returns: "),a("code",[t._v("{ZCFSeatRecord, Promise<UserSeat>}")])])]),t._v(" "),a("p",[t._v("Returns an empty "),a("code",[t._v("zcfSeatRecord")]),t._v(" and a "),a("code",[t._v("promise")]),t._v(" for a "),a("code",[t._v("userSeat")])]),t._v(" "),a("p",[t._v("Zoe uses "),a("code",[t._v("seats")]),t._v(" to represent offers, and has two "),a("code",[t._v("seat")]),t._v(" facets (a particular view or API of an object;\nthere may be multiple such APIs per object) a "),a("code",[t._v("ZCFSeat")]),t._v(" and a "),a("code",[t._v("UserSeat")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" zcfSeat"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" mySeat "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("makeEmptySeatKit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-getbrandforissuer-issuer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getbrandforissuer-issuer"}},[t._v("#")]),t._v(" zcf.getBrandForIssuer(issuer)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("issuer")]),t._v(" "),a("code",[t._v("{Issuer}")])]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{Brand}")])])]),t._v(" "),a("p",[t._v("Returns the "),a("code",[t._v("brand")]),t._v(" associated with the "),a("code",[t._v("issuer")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"zcf-getissuerforbrand-brand"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getissuerforbrand-brand"}},[t._v("#")]),t._v(" zcf.getIssuerForBrand(brand)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("brand")]),t._v(" "),a("code",[t._v("{Brand}")])]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{Issuer}")])])]),t._v(" "),a("p",[t._v("Returns the "),a("code",[t._v("issuer")]),t._v(" of the "),a("code",[t._v("brand")]),t._v(" argument.")]),t._v(" "),a("h2",{attrs:{id:"zcf-getamountmath-brand"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getamountmath-brand"}},[t._v("#")]),t._v(" zcf.getAmountMath(brand)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("brand")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{amountMath}")])])]),t._v(" "),a("p",[t._v("Returns the "),a("code",[t._v("amountMath")]),t._v(" object associated with the "),a("code",[t._v("brand")]),t._v(" argument.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" assetAmountMath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAmountMath")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("assetAmount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("brand"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-shutdown"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-shutdown"}},[t._v("#")]),t._v(" zcf.shutdown()")]),t._v(" "),a("p",[a("strong",[t._v("Note")]),t._v(": Still in development, use at your own risk.")]),t._v(" "),a("p",[t._v("Shuts down the entire vat and gives payouts.")]),t._v(" "),a("p",[t._v("This exits all "),a("code",[t._v("seats")]),t._v(" associated with the current "),a("code",[t._v("instance")]),t._v(",\ngiving them their payouts.")]),t._v(" "),a("p",[t._v("Call when:")]),t._v(" "),a("ul",[a("li",[t._v("You want nothing more to happen in the contract, and")]),t._v(" "),a("li",[t._v("You don't want to take any more offers")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shutdown")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-getterms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getterms"}},[t._v("#")]),t._v(" zcf.getTerms()")]),t._v(" "),a("ul",[a("li",[t._v("Returns: "),a("code",[t._v("{Object}")])])]),t._v(" "),a("p",[t._v("Returns the "),a("code",[t._v("issuers")]),t._v(", "),a("code",[t._v("brands")]),t._v(", and custom "),a("code",[t._v("terms")]),t._v(" the current contract instance was instantiated with.")]),t._v(" "),a("p",[t._v("Note that there is also an "),a("code",[t._v("E(zoe).getTerms(instance)")]),t._v(". Often the choice of which to use is not which method\nto use, but which of Zoe Service or ZCF you have access to. On the contract side, you more easily have access\nto "),a("code",[t._v("zcf")]),t._v(", and "),a("code",[t._v("zcf")]),t._v(" already knows what instance is running. So in contract code, you use "),a("code",[t._v("zcf.getTerms()")]),t._v(". From\na user side, with access to Zoe Service, you use "),a("code",[t._v("E(zoe).getTerms()")]),t._v(".")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" brands"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" issuers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" terms "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTerms")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-getzoeservice"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-getzoeservice"}},[t._v("#")]),t._v(" zcf.getZoeService()")]),t._v(" "),a("ul",[a("li",[t._v("Returns: "),a("router-link",{attrs:{to:"/zoe/api/zoe.html#zoe"}},[a("code",[t._v("{ZoeService}")])])],1)]),t._v(" "),a("p",[t._v("This is the only way to get the user-facing "),a("router-link",{attrs:{to:"/zoe/api/zoe.html#zoe"}},[t._v("Zoe Service API")]),t._v(" to\nthe contract code as well.")],1),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Making an offer to another contract instance in the contract.")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" zoeService "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getZoeService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("E")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("zoeService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("offer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("creatorInvitation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" proposal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" paymentKeywordRecord"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-assertuniquekeyword-keyword"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-assertuniquekeyword-keyword"}},[t._v("#")]),t._v(" zcf.assertUniqueKeyword(keyword)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("keyword")]),t._v(" "),a("code",[t._v("{String}")])]),t._v(" "),a("li",[t._v("Returns: Undefined")])]),t._v(" "),a("p",[t._v("Checks if a keyword is valid and not already used as a "),a("code",[t._v("brand")]),t._v(" in this "),a("code",[t._v("instance")]),t._v(" (i.e. unique)\nand could be used as a new "),a("code",[t._v("brand")]),t._v(" to make an "),a("code",[t._v("issuer")]),t._v(". Throws an appropriate error if it's not\na valid keyword, or is not unique.")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("assertUniqueKeyword")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keyword"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"zcf-reallocate-seatstagings"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#zcf-reallocate-seatstagings"}},[t._v("#")]),t._v(" zcf.reallocate(seatStagings)")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("seatStagings")]),t._v(" "),a("code",[t._v("{SeatStaging[]}")]),t._v(" (at least two)")]),t._v(" "),a("li",[t._v("Returns: "),a("code",[t._v("{void}")])])]),t._v(" "),a("p",[t._v("The contract reallocates over "),a("code",[t._v("seatStagings")]),t._v(", which are\nassociations of "),a("code",[t._v("seats")]),t._v(" with new "),a("code",[t._v("allocations")]),t._v(" to be used in reallocation.\nThere must be at least two "),a("code",[t._v("seatStagings")]),t._v(" in the array argument.")]),t._v(" "),a("p",[t._v("The reallocation only succeeds if it:")]),t._v(" "),a("ol",[a("li",[t._v("Conserves rights (the specified "),a("code",[t._v("amounts")]),t._v(" have the same total value as the\ncurrent total amount)")]),t._v(" "),a("li",[t._v("Is 'offer-safe' for all parties\ninvolved. Offer safety is checked at the staging step.")])]),t._v(" "),a("p",[t._v("The reallocation is partial, only applying to "),a("code",[t._v("seats")]),t._v(" associated\nwith the "),a("code",[t._v("seatStagings")]),t._v(". By induction, if rights conservation and\noffer safety hold before, they hold after a safe reallocation.")]),t._v(" "),a("p",[t._v("This is true even though we only re-validate for "),a("code",[t._v("seats")]),t._v(" whose\n"),a("code",[t._v("allocations")]),t._v(" change. A reallocation can only effect offer safety for\nthose "),a("code",[t._v("seats")]),t._v(", and since rights are conserved for the change, overall\nrights are unchanged.")]),t._v(" "),a("p",[a("code",[t._v("reallocate()")]),t._v(" throws these errors:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("reallocating must be done over two or more seats")])]),t._v(" "),a("li",[a("code",[t._v("The seatStaging was not recognized")])]),t._v(" "),a("li",[a("code",[t._v("The seatStaging was not recognized")])]),t._v(" "),a("li",[a("code",[t._v("keyword must be unique")])]),t._v(" "),a("li",[t._v("If the total "),a("code",[t._v("amount")]),t._v(" per "),a("code",[t._v("brand")]),t._v(" is not equal to the total "),a("code",[t._v("amount")]),t._v(" per "),a("code",[t._v("brand")]),t._v("\nin the proposed reallocation. (no message)")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("zcf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reallocate")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    seat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seatAAllocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    seat"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("seatBAllocation"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])],1)}),[],!1,null,null,null);e.default=n.exports}}]);